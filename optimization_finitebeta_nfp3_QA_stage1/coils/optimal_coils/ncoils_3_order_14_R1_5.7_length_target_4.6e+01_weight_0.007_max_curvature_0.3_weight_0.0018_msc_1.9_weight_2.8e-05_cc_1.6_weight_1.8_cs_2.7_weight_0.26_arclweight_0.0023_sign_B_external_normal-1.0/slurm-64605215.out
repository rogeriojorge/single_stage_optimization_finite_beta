SAVING NO SHEET CURRENT SOLVE TO  /projects/EKOLEMEN/DESC/single_stage_optimization_finite_beta/optimization_finitebeta_nfp3_QA_stage1/coils/optimal_coils/ncoils_3_order_14_R1_5.7_length_target_4.6e+01_weight_0.007_max_curvature_0.3_weight_0.0018_msc_1.9_weight_2.8e-05_cc_1.6_weight_1.8_cs_2.7_weight_0.26_arclweight_0.0023_sign_B_external_normal-1.0/desc_fb_no_sheet_current.h5
SAVING  SHEET CURRENT SOLVE TO  /projects/EKOLEMEN/DESC/single_stage_optimization_finite_beta/optimization_finitebeta_nfp3_QA_stage1/coils/optimal_coils/ncoils_3_order_14_R1_5.7_length_target_4.6e+01_weight_0.007_max_curvature_0.3_weight_0.0018_msc_1.9_weight_2.8e-05_cc_1.6_weight_1.8_cs_2.7_weight_0.26_arclweight_0.0023_sign_B_external_normal-1.0/desc_fb_with_sheet_current.h5
/home/dpanici/DESC/desc/input_reader.py:1267: UserWarning: Current is not a power series!
  warnings.warn(colored("Current is not a power series!", "yellow"))
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Current on axis is nonzero, got -7.553e+02 Amps
  warnings.warn(colored(msg, "yellow"), err)
eq psi = 53.5846837754596
field psi = -53.9494485373706

==================================
Optimizing boundary modes M,N <= 1
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 178 ms
Timer: Objective build = 2.48 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 868 ms
Timer: Objective build = 932 ms
Timer: Objective build = 2.81 ms
Timer: Eq Update LinearConstraintProjection build = 6.08 sec
Timer: Proximal projection build = 12.6 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 642 ms
Timer: LinearConstraintProjection build = 2.79 sec
Number of parameters: 9
Number of objectives: 3362
Timer: Initializing the optimization = 16.1 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          5.242e-05                                    4.823e-04   
       1              2          5.173e-05      6.953e-07      7.995e-03      4.383e-05   
       2              3          5.152e-05      2.084e-07      4.932e-03      9.824e-05   
       3             27          5.152e-05      0.000e+00      0.000e+00      9.824e-05   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 5.152e-05
         Total delta_x: 5.953e-03
         Iterations: 3
         Function evaluations: 27
         Jacobian evaluations: 3
Timer: Solution time = 5.46 min
Timer: Avg time per step = 1.36 min
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      5.242e-05  -->   5.152e-05, 
Maximum absolute Boundary normal field error:                4.607e-01  -->   4.516e-01 (T*m^2)
Minimum absolute Boundary normal field error:                3.131e-14  -->   2.063e-14 (T*m^2)
Average absolute Boundary normal field error:                9.954e-02  -->   9.696e-02 (T*m^2)
Maximum absolute Boundary normal field error:                3.338e-03  -->   3.273e-03 (normalized)
Minimum absolute Boundary normal field error:                2.269e-16  -->   1.495e-16 (normalized)
Average absolute Boundary normal field error:                7.213e-04  -->   7.026e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           5.481e+00  -->   5.241e+00 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           8.766e-04  -->   6.909e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.077e+00  -->   1.079e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           5.513e-03  -->   5.271e-03 (normalized)
Minimum absolute Boundary magnetic pressure error:           8.817e-07  -->   6.950e-06 (normalized)
Average absolute Boundary magnetic pressure error:           1.083e-03  -->   1.086e-03 (normalized)
Maximum absolute Force error:                                2.559e+05  -->   3.007e+05 (N)
Minimum absolute Force error:                                8.429e-01  -->   2.009e+00 (N)
Average absolute Force error:                                6.218e+03  -->   5.992e+03 (N)
Maximum absolute Force error:                                3.278e-05  -->   3.851e-05 (normalized)
Minimum absolute Force error:                                1.080e-10  -->   2.574e-10 (normalized)
Average absolute Force error:                                7.964e-07  -->   7.675e-07 (normalized)
R boundary error:                                            0.000e+00  -->   3.879e-18 (m)
Z boundary error:                                            0.000e+00  -->   4.358e-33 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   1.863e-09 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 2
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 184 ms
Timer: Objective build = 2.59 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 889 ms
Timer: Objective build = 953 ms
Timer: Objective build = 1.90 ms
Timer: Eq Update LinearConstraintProjection build = 6.03 sec
Timer: Proximal projection build = 12.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 652 ms
Timer: LinearConstraintProjection build = 2.77 sec
Number of parameters: 25
Number of objectives: 3362
Timer: Initializing the optimization = 16.3 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          5.157e-05                                    1.196e-03   
       1              3          4.960e-05      1.979e-06      5.214e-02      2.186e-03   
       2              4          4.665e-05      2.949e-06      3.761e-02      1.695e-04   
       3              5          4.642e-05      2.230e-07      2.280e-02      3.132e-05   
       4             30          4.642e-05      0.000e+00      0.000e+00      3.132e-05   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 4.642e-05
         Total delta_x: 7.443e-02
         Iterations: 4
         Function evaluations: 30
         Jacobian evaluations: 4
Timer: Solution time = 3.38 min
Timer: Avg time per step = 40.5 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      5.155e-05  -->   4.642e-05, 
Maximum absolute Boundary normal field error:                4.516e-01  -->   3.126e-01 (T*m^2)
Minimum absolute Boundary normal field error:                2.063e-14  -->   4.888e-14 (T*m^2)
Average absolute Boundary normal field error:                9.696e-02  -->   9.241e-02 (T*m^2)
Maximum absolute Boundary normal field error:                3.273e-03  -->   2.265e-03 (normalized)
Minimum absolute Boundary normal field error:                1.495e-16  -->   3.542e-16 (normalized)
Average absolute Boundary normal field error:                7.026e-04  -->   6.696e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           5.241e+00  -->   3.868e+00 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           6.909e-03  -->   3.334e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.079e+00  -->   1.071e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           5.274e-03  -->   3.892e-03 (normalized)
Minimum absolute Boundary magnetic pressure error:           6.953e-06  -->   3.355e-06 (normalized)
Average absolute Boundary magnetic pressure error:           1.086e-03  -->   1.078e-03 (normalized)
Maximum absolute Force error:                                3.007e+05  -->   2.982e+05 (N)
Minimum absolute Force error:                                2.009e+00  -->   4.465e-01 (N)
Average absolute Force error:                                5.992e+03  -->   5.843e+03 (N)
Maximum absolute Force error:                                3.852e-05  -->   3.821e-05 (normalized)
Minimum absolute Force error:                                2.575e-10  -->   5.722e-11 (normalized)
Average absolute Force error:                                7.678e-07  -->   7.487e-07 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   4.358e-33 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   1.473e-09 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 4
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 196 ms
Timer: Objective build = 2.63 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 885 ms
Timer: Objective build = 951 ms
Timer: Objective build = 1.91 ms
Timer: Eq Update LinearConstraintProjection build = 5.82 sec
Timer: Proximal projection build = 12.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 653 ms
Timer: LinearConstraintProjection build = 2.55 sec
Number of parameters: 81
Number of objectives: 3362
Timer: Initializing the optimization = 16.1 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          4.625e-05                                    2.435e-03   
       1              5          2.686e-05      1.939e-05      1.849e-02      4.011e-04   
       2              6          2.594e-05      9.239e-07      3.885e-02      1.904e-03   
       3              7          2.189e-05      4.042e-06      3.375e-02      1.058e-03   
       4              9          1.905e-05      2.841e-06      1.607e-02      2.215e-04   
       5             10          1.654e-05      2.508e-06      3.521e-02      9.473e-04   
       6             12          1.401e-05      2.534e-06      1.819e-02      2.323e-04   
       7             13          1.312e-05      8.895e-07      4.252e-02      1.261e-03   
       8             14          1.097e-05      2.151e-06      4.036e-02      1.285e-03   
       9             15          8.545e-06      2.425e-06      3.582e-02      1.035e-03   
      10             17          6.573e-06      1.972e-06      1.962e-02      3.115e-04   
      11             19          6.007e-06      5.664e-07      1.150e-02      1.397e-04   
      12             20          5.747e-06      2.597e-07      2.546e-02      5.259e-04   
      13             21          5.397e-06      3.499e-07      2.458e-02      5.060e-04   
      14             22          5.138e-06      2.594e-07      2.365e-02      4.714e-04   
      15             23          4.923e-06      2.151e-07      2.297e-02      4.358e-04   
      16             24          4.762e-06      1.604e-07      2.219e-02      3.932e-04   
      17             25          4.671e-06      9.099e-08      2.096e-02      3.454e-04   
      18             26          4.527e-06      1.448e-07      1.970e-02      3.067e-04   
      19             27          4.395e-06      1.312e-07      1.910e-02      2.872e-04   
      20             28          4.271e-06      1.240e-07      1.844e-02      2.727e-04   
      21             29          4.156e-06      1.156e-07      1.784e-02      2.555e-04   
      22             30          4.054e-06      1.018e-07      1.724e-02      2.359e-04   
      23             31          3.973e-06      8.086e-08      1.664e-02      2.146e-04   
      24             33          3.925e-06      4.768e-08      4.091e-03      1.441e-05   
      25             35          3.917e-06      8.770e-09      2.076e-03      4.236e-06   
      26             59          3.917e-06      0.000e+00      0.000e+00      4.236e-06   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 3.917e-06
         Total delta_x: 4.325e-01
         Iterations: 26
         Function evaluations: 59
         Jacobian evaluations: 26
Timer: Solution time = 14.6 min
Timer: Avg time per step = 32.6 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      4.625e-05  -->   3.917e-06, 
Maximum absolute Boundary normal field error:                3.126e-01  -->   1.257e-01 (T*m^2)
Minimum absolute Boundary normal field error:                4.888e-14  -->   2.572e-14 (T*m^2)
Average absolute Boundary normal field error:                9.241e-02  -->   3.915e-02 (T*m^2)
Maximum absolute Boundary normal field error:                2.259e-03  -->   9.086e-04 (normalized)
Minimum absolute Boundary normal field error:                3.533e-16  -->   1.858e-16 (normalized)
Average absolute Boundary normal field error:                6.678e-04  -->   2.829e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           3.868e+00  -->   8.891e-01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           3.334e-03  -->   5.536e-05 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.071e+00  -->   2.166e-01 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           3.886e-03  -->   8.934e-04 (normalized)
Minimum absolute Boundary magnetic pressure error:           3.350e-06  -->   5.562e-08 (normalized)
Average absolute Boundary magnetic pressure error:           1.076e-03  -->   2.176e-04 (normalized)
Maximum absolute Force error:                                2.982e+05  -->   1.248e+05 (N)
Minimum absolute Force error:                                4.465e-01  -->   1.034e+00 (N)
Average absolute Force error:                                5.843e+03  -->   5.058e+03 (N)
Maximum absolute Force error:                                3.815e-05  -->   1.597e-05 (normalized)
Minimum absolute Force error:                                5.713e-11  -->   1.323e-10 (normalized)
Average absolute Force error:                                7.475e-07  -->   6.470e-07 (normalized)
R boundary error:                                            0.000e+00  -->   3.081e-33 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   1.490e-08 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 5
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 188 ms
Timer: Objective build = 2.77 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 887 ms
Timer: Objective build = 952 ms
Timer: Objective build = 1.93 ms
Timer: Eq Update LinearConstraintProjection build = 6.25 sec
Timer: Proximal projection build = 13.2 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 665 ms
Timer: LinearConstraintProjection build = 2.58 sec
Number of parameters: 121
Number of objectives: 3362
Timer: Initializing the optimization = 16.6 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          3.879e-06                                    3.550e-04   
       1              5          2.872e-06      1.007e-06      8.148e-03      9.088e-05   
       2              6          2.346e-06      5.257e-07      1.600e-02      2.106e-04   
       3              8          2.182e-06      1.646e-07      8.616e-03      5.910e-05   
       4              9          2.033e-06      1.487e-07      1.656e-02      1.896e-04   
       5             11          1.921e-06      1.118e-07      7.900e-03      5.027e-05   
       6             12          1.791e-06      1.304e-07      1.678e-02      2.327e-04   
       7             14          1.615e-06      1.756e-07      8.289e-03      5.075e-05   
       8             15          1.498e-06      1.174e-07      1.645e-02      1.960e-04   
       9             16          1.312e-06      1.855e-07      1.627e-02      2.267e-04   
      10             18          1.220e-06      9.283e-08      9.264e-03      7.191e-05   
      11             20          1.199e-06      2.103e-08      5.182e-03      2.315e-05   
      12             21          1.177e-06      2.129e-08      1.085e-02      1.043e-04   
      13             22          1.156e-06      2.153e-08      1.095e-02      9.570e-05   
      14             23          1.141e-06      1.521e-08      1.105e-02      9.694e-05   
      15             24          1.125e-06      1.533e-08      1.119e-02      9.700e-05   
      16             25          1.112e-06      1.298e-08      1.161e-02      1.004e-04   
      17             26          1.104e-06      8.412e-09      1.203e-02      1.025e-04   
      18             27          1.095e-06      8.791e-09      1.237e-02      1.011e-04   
      19             28          1.082e-06      1.293e-08      1.237e-02      9.547e-05   
      20             29          1.061e-06      2.058e-08      1.215e-02      8.760e-05   
      21             30          1.012e-06      4.924e-08      1.188e-02      9.724e-05   
      22             32          9.547e-07      5.751e-08      6.869e-03      4.438e-05   
      23             34          9.441e-07      1.063e-08      3.402e-03      1.013e-05   
      24             35          9.373e-07      6.774e-09      6.823e-03      3.592e-05   
      25             36          9.328e-07      4.594e-09      6.812e-03      3.420e-05   
      26             37          9.296e-07      3.144e-09      6.827e-03      3.374e-05   
      27             38          9.287e-07      9.467e-10      1.700e-03      2.820e-06   
      28             60          9.287e-07      0.000e+00      0.000e+00      2.820e-06   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 9.287e-07
         Total delta_x: 2.136e-01
         Iterations: 28
         Function evaluations: 60
         Jacobian evaluations: 28
Timer: Solution time = 13.1 min
Timer: Avg time per step = 27.1 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      3.878e-06  -->   9.287e-07, 
Maximum absolute Boundary normal field error:                1.257e-01  -->   7.904e-02 (T*m^2)
Minimum absolute Boundary normal field error:                2.572e-14  -->   3.716e-14 (T*m^2)
Average absolute Boundary normal field error:                3.915e-02  -->   2.344e-02 (T*m^2)
Maximum absolute Boundary normal field error:                9.080e-04  -->   5.708e-04 (normalized)
Minimum absolute Boundary normal field error:                1.857e-16  -->   2.683e-16 (normalized)
Average absolute Boundary normal field error:                2.827e-04  -->   1.692e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           8.891e-01  -->   2.682e-01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           5.536e-05  -->   1.058e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           2.166e-01  -->   6.442e-02 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           8.832e-04  -->   2.664e-04 (normalized)
Minimum absolute Boundary magnetic pressure error:           5.498e-08  -->   1.051e-07 (normalized)
Average absolute Boundary magnetic pressure error:           2.152e-04  -->   6.399e-05 (normalized)
Maximum absolute Force error:                                1.248e+05  -->   1.313e+05 (N)
Minimum absolute Force error:                                1.034e+00  -->   6.989e-02 (N)
Average absolute Force error:                                5.058e+03  -->   6.403e+03 (N)
Maximum absolute Force error:                                1.579e-05  -->   1.660e-05 (normalized)
Minimum absolute Force error:                                1.308e-10  -->   8.839e-12 (normalized)
Average absolute Force error:                                6.396e-07  -->   8.097e-07 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   9.313e-10 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 7
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 186 ms
Timer: Objective build = 2.65 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 892 ms
Timer: Objective build = 958 ms
Timer: Objective build = 1.94 ms
Timer: Eq Update LinearConstraintProjection build = 6.28 sec
Timer: Proximal projection build = 13.1 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 651 ms
Timer: LinearConstraintProjection build = 2.83 sec
Number of parameters: 225
Number of objectives: 3362
Timer: Initializing the optimization = 16.7 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          9.359e-07                                    2.066e-04   
       1              7          7.460e-07      1.899e-07      2.805e-04      9.221e-05   
       2              9          7.066e-07      3.943e-08      1.329e-04      5.344e-05   
       3             31          7.066e-07      0.000e+00      0.000e+00      5.344e-05   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 7.066e-07
         Total delta_x: 4.046e-04
         Iterations: 3
         Function evaluations: 31
         Jacobian evaluations: 3
Timer: Solution time = 6.91 min
Timer: Avg time per step = 1.72 min
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      9.359e-07  -->   7.066e-07, 
Maximum absolute Boundary normal field error:                7.904e-02  -->   7.599e-02 (T*m^2)
Minimum absolute Boundary normal field error:                3.716e-14  -->   3.064e-14 (T*m^2)
Average absolute Boundary normal field error:                2.344e-02  -->   2.049e-02 (T*m^2)
Maximum absolute Boundary normal field error:                5.730e-04  -->   5.508e-04 (normalized)
Minimum absolute Boundary normal field error:                2.694e-16  -->   2.221e-16 (normalized)
Average absolute Boundary normal field error:                1.699e-04  -->   1.485e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           2.682e-01  -->   1.902e-01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           1.058e-04  -->   1.812e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           6.442e-02  -->   5.182e-02 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.676e-04  -->   1.898e-04 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.056e-07  -->   1.808e-07 (normalized)
Average absolute Boundary magnetic pressure error:           6.428e-05  -->   5.171e-05 (normalized)
Maximum absolute Force error:                                1.313e+05  -->   2.014e+05 (N)
Minimum absolute Force error:                                6.989e-02  -->   9.221e-01 (N)
Average absolute Force error:                                6.403e+03  -->   6.738e+03 (N)
Maximum absolute Force error:                                1.668e-05  -->   2.558e-05 (normalized)
Minimum absolute Force error:                                8.879e-12  -->   1.172e-10 (normalized)
Average absolute Force error:                                8.134e-07  -->   8.560e-07 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   8.330e-09 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 8
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 195 ms
Timer: Objective build = 2.79 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 897 ms
Timer: Objective build = 962 ms
Timer: Objective build = 1.93 ms
Timer: Eq Update LinearConstraintProjection build = 6.22 sec
Timer: Proximal projection build = 13.2 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 634 ms
Timer: LinearConstraintProjection build = 2.82 sec
Number of parameters: 289
Number of objectives: 3362
Timer: Initializing the optimization = 16.7 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          7.066e-07                                    2.307e-04   
       1             28          7.066e-07      0.000e+00      0.000e+00      2.307e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 7.066e-07
         Total delta_x: 0.000e+00
         Iterations: 1
         Function evaluations: 28
         Jacobian evaluations: 1
Timer: Solution time = 6.30 min
Timer: Avg time per step = 3.15 min
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      7.066e-07  -->   7.066e-07, 
Maximum absolute Boundary normal field error:                7.599e-02  -->   7.599e-02 (T*m^2)
Minimum absolute Boundary normal field error:                3.064e-14  -->   3.064e-14 (T*m^2)
Average absolute Boundary normal field error:                2.049e-02  -->   2.049e-02 (T*m^2)
Maximum absolute Boundary normal field error:                5.508e-04  -->   5.508e-04 (normalized)
Minimum absolute Boundary normal field error:                2.221e-16  -->   2.221e-16 (normalized)
Average absolute Boundary normal field error:                1.485e-04  -->   1.485e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.902e-01  -->   1.902e-01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           1.812e-04  -->   1.812e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           5.182e-02  -->   5.182e-02 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.898e-04  -->   1.898e-04 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.808e-07  -->   1.808e-07 (normalized)
Average absolute Boundary magnetic pressure error:           5.171e-05  -->   5.171e-05 (normalized)
Maximum absolute Force error:                                2.014e+05  -->   2.014e+05 (N)
Minimum absolute Force error:                                9.221e-01  -->   9.221e-01 (N)
Average absolute Force error:                                6.738e+03  -->   6.738e+03 (N)
Maximum absolute Force error:                                2.558e-05  -->   2.558e-05 (normalized)
Minimum absolute Force error:                                1.171e-10  -->   1.171e-10 (normalized)
Average absolute Force error:                                8.560e-07  -->   8.560e-07 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 10
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 187 ms
Timer: Objective build = 2.65 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 888 ms
Timer: Objective build = 954 ms
Timer: Objective build = 1.93 ms
Timer: Eq Update LinearConstraintProjection build = 6.07 sec
Timer: Proximal projection build = 13.1 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 527 ms
Timer: LinearConstraintProjection build = 2.65 sec
Number of parameters: 441
Number of objectives: 3362
Timer: Initializing the optimization = 16.4 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          7.066e-07                                    4.608e-04   
       1              9          6.737e-07      3.289e-08      6.723e-06      3.958e-04   
       2             10          6.306e-07      4.315e-08      1.307e-05      2.868e-04   
       3             31          6.306e-07      0.000e+00      0.000e+00      2.868e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 6.306e-07
         Total delta_x: 1.970e-05
         Iterations: 3
         Function evaluations: 31
         Jacobian evaluations: 3
Timer: Solution time = 10.9 min
Timer: Avg time per step = 2.72 min
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      7.066e-07  -->   6.306e-07, 
Maximum absolute Boundary normal field error:                7.599e-02  -->   7.479e-02 (T*m^2)
Minimum absolute Boundary normal field error:                3.064e-14  -->   5.547e-14 (T*m^2)
Average absolute Boundary normal field error:                2.049e-02  -->   1.931e-02 (T*m^2)
Maximum absolute Boundary normal field error:                5.508e-04  -->   5.422e-04 (normalized)
Minimum absolute Boundary normal field error:                2.221e-16  -->   4.021e-16 (normalized)
Average absolute Boundary normal field error:                1.485e-04  -->   1.400e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.902e-01  -->   1.835e-01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           1.812e-04  -->   9.376e-05 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           5.182e-02  -->   4.826e-02 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.898e-04  -->   1.831e-04 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.808e-07  -->   9.356e-08 (normalized)
Average absolute Boundary magnetic pressure error:           5.171e-05  -->   4.816e-05 (normalized)
Maximum absolute Force error:                                2.014e+05  -->   1.986e+05 (N)
Minimum absolute Force error:                                9.221e-01  -->   2.799e-01 (N)
Average absolute Force error:                                6.738e+03  -->   7.100e+03 (N)
Maximum absolute Force error:                                2.558e-05  -->   2.524e-05 (normalized)
Minimum absolute Force error:                                1.171e-10  -->   3.556e-11 (normalized)
Average absolute Force error:                                8.560e-07  -->   9.020e-07 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   3.725e-09 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 1
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 526 ms
Timer: Objective build = 2.95 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 880 ms
Timer: Objective build = 943 ms
Timer: Objective build = 1.70 ms
Timer: Eq Update LinearConstraintProjection build = 6.36 sec
Timer: Proximal projection build = 13.7 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 675 ms
Timer: LinearConstraintProjection build = 2.88 sec
Number of parameters: 23
Number of objectives: 5043
Timer: Initializing the optimization = 17.4 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.200e-06                                    3.044e-04   
       1              2          1.172e-06      2.744e-08      9.801e+03      1.995e-04   
       2             25          1.172e-06      0.000e+00      0.000e+00      1.995e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.172e-06
         Total delta_x: 9.801e+03
         Iterations: 2
         Function evaluations: 25
         Jacobian evaluations: 2
Timer: Solution time = 18.1 min
Timer: Avg time per step = 6.05 min
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.200e-06  -->   1.172e-06, 
Maximum absolute Boundary normal field error:                7.479e-02  -->   7.116e-02 (T*m^2)
Minimum absolute Boundary normal field error:                5.547e-14  -->   5.361e-14 (T*m^2)
Average absolute Boundary normal field error:                1.931e-02  -->   1.883e-02 (T*m^2)
Maximum absolute Boundary normal field error:                5.422e-04  -->   5.158e-04 (normalized)
Minimum absolute Boundary normal field error:                4.021e-16  -->   3.886e-16 (normalized)
Average absolute Boundary normal field error:                1.400e-04  -->   1.365e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.835e-01  -->   1.969e-01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           9.376e-05  -->   3.388e-05 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           4.826e-02  -->   4.893e-02 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.831e-04  -->   1.964e-04 (normalized)
Minimum absolute Boundary magnetic pressure error:           9.356e-08  -->   3.380e-08 (normalized)
Average absolute Boundary magnetic pressure error:           4.816e-05  -->   4.882e-05 (normalized)
Maximum absolute Boundary field jump error:                  6.870e-02  -->   6.884e-02 (T*m^2)
Minimum absolute Boundary field jump error:                  2.809e-04  -->   5.453e-04 (T*m^2)
Average absolute Boundary field jump error:                  2.007e-02  -->   2.010e-02 (T*m^2)
Maximum absolute Boundary field jump error:                  4.980e-04  -->   4.990e-04 (normalized)
Minimum absolute Boundary field jump error:                  2.036e-06  -->   3.953e-06 (normalized)
Average absolute Boundary field jump error:                  1.455e-04  -->   1.457e-04 (normalized)
Maximum absolute Force error:                                1.986e+05  -->   1.969e+05 (N)
Minimum absolute Force error:                                2.799e-01  -->   2.173e-02 (N)
Average absolute Force error:                                7.100e+03  -->   7.094e+03 (N)
Maximum absolute Force error:                                2.524e-05  -->   2.501e-05 (normalized)
Minimum absolute Force error:                                3.556e-11  -->   2.761e-12 (normalized)
Average absolute Force error:                                9.020e-07  -->   9.013e-07 (normalized)
R boundary error:                                            0.000e+00  -->   1.052e-17 (m)
Z boundary error:                                            0.000e+00  -->   9.677e-18 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 2
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 534 ms
Timer: Objective build = 3.18 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 879 ms
Timer: Objective build = 944 ms
Timer: Objective build = 1.68 ms
Timer: Eq Update LinearConstraintProjection build = 6.36 sec
Timer: Proximal projection build = 13.9 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 670 ms
Timer: LinearConstraintProjection build = 2.87 sec
Number of parameters: 39
Number of objectives: 5043
Timer: Initializing the optimization = 17.5 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.172e-06                                    1.995e-04   
       1             25          1.172e-06      0.000e+00      0.000e+00      1.995e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.172e-06
         Total delta_x: 0.000e+00
         Iterations: 1
         Function evaluations: 25
         Jacobian evaluations: 1
Timer: Solution time = 18.8 min
Timer: Avg time per step = 9.44 min
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.172e-06  -->   1.172e-06, 
Maximum absolute Boundary normal field error:                7.116e-02  -->   7.116e-02 (T*m^2)
Minimum absolute Boundary normal field error:                5.361e-14  -->   5.361e-14 (T*m^2)
Average absolute Boundary normal field error:                1.883e-02  -->   1.883e-02 (T*m^2)
Maximum absolute Boundary normal field error:                5.159e-04  -->   5.159e-04 (normalized)
Minimum absolute Boundary normal field error:                3.886e-16  -->   3.886e-16 (normalized)
Average absolute Boundary normal field error:                1.365e-04  -->   1.365e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.969e-01  -->   1.969e-01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           3.388e-05  -->   3.388e-05 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           4.893e-02  -->   4.893e-02 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.964e-04  -->   1.964e-04 (normalized)
Minimum absolute Boundary magnetic pressure error:           3.380e-08  -->   3.380e-08 (normalized)
Average absolute Boundary magnetic pressure error:           4.882e-05  -->   4.882e-05 (normalized)
Maximum absolute Boundary field jump error:                  6.884e-02  -->   6.884e-02 (T*m^2)
Minimum absolute Boundary field jump error:                  5.453e-04  -->   5.453e-04 (T*m^2)
Average absolute Boundary field jump error:                  2.010e-02  -->   2.010e-02 (T*m^2)
Maximum absolute Boundary field jump error:                  4.990e-04  -->   4.990e-04 (normalized)
Minimum absolute Boundary field jump error:                  3.953e-06  -->   3.953e-06 (normalized)
Average absolute Boundary field jump error:                  1.457e-04  -->   1.457e-04 (normalized)
Maximum absolute Force error:                                1.969e+05  -->   1.969e+05 (N)
Minimum absolute Force error:                                2.173e-02  -->   2.173e-02 (N)
Average absolute Force error:                                7.094e+03  -->   7.094e+03 (N)
Maximum absolute Force error:                                2.501e-05  -->   2.501e-05 (normalized)
Minimum absolute Force error:                                2.761e-12  -->   2.761e-12 (normalized)
Average absolute Force error:                                9.012e-07  -->   9.012e-07 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 4
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 527 ms
Timer: Objective build = 2.95 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 883 ms
Timer: Objective build = 947 ms
Timer: Objective build = 1.71 ms
Timer: Eq Update LinearConstraintProjection build = 6.41 sec
Timer: Proximal projection build = 13.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 680 ms
Timer: LinearConstraintProjection build = 2.58 sec
Number of parameters: 95
Number of objectives: 5043
Timer: Initializing the optimization = 17.2 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.172e-06                                    1.995e-04   
       1             26          1.172e-06      0.000e+00      0.000e+00      1.995e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.172e-06
         Total delta_x: 0.000e+00
         Iterations: 1
         Function evaluations: 26
         Jacobian evaluations: 1
Timer: Solution time = 18.8 min
Timer: Avg time per step = 9.41 min
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.172e-06  -->   1.172e-06, 
Maximum absolute Boundary normal field error:                7.116e-02  -->   7.116e-02 (T*m^2)
Minimum absolute Boundary normal field error:                5.361e-14  -->   5.361e-14 (T*m^2)
Average absolute Boundary normal field error:                1.883e-02  -->   1.883e-02 (T*m^2)
Maximum absolute Boundary normal field error:                5.159e-04  -->   5.159e-04 (normalized)
Minimum absolute Boundary normal field error:                3.886e-16  -->   3.886e-16 (normalized)
Average absolute Boundary normal field error:                1.365e-04  -->   1.365e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.969e-01  -->   1.969e-01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           3.388e-05  -->   3.388e-05 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           4.893e-02  -->   4.893e-02 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.964e-04  -->   1.964e-04 (normalized)
Minimum absolute Boundary magnetic pressure error:           3.380e-08  -->   3.380e-08 (normalized)
Average absolute Boundary magnetic pressure error:           4.882e-05  -->   4.882e-05 (normalized)
Maximum absolute Boundary field jump error:                  6.884e-02  -->   6.884e-02 (T*m^2)
Minimum absolute Boundary field jump error:                  5.453e-04  -->   5.453e-04 (T*m^2)
Average absolute Boundary field jump error:                  2.010e-02  -->   2.010e-02 (T*m^2)
Maximum absolute Boundary field jump error:                  4.990e-04  -->   4.990e-04 (normalized)
Minimum absolute Boundary field jump error:                  3.953e-06  -->   3.953e-06 (normalized)
Average absolute Boundary field jump error:                  1.457e-04  -->   1.457e-04 (normalized)
Maximum absolute Force error:                                1.969e+05  -->   1.969e+05 (N)
Minimum absolute Force error:                                2.173e-02  -->   2.173e-02 (N)
Average absolute Force error:                                7.094e+03  -->   7.094e+03 (N)
Maximum absolute Force error:                                2.501e-05  -->   2.501e-05 (normalized)
Minimum absolute Force error:                                2.761e-12  -->   2.761e-12 (normalized)
Average absolute Force error:                                9.012e-07  -->   9.012e-07 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 5
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 527 ms
Timer: Objective build = 2.91 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 860 ms
Timer: Objective build = 924 ms
Timer: Objective build = 1.68 ms
Timer: Eq Update LinearConstraintProjection build = 6.07 sec
Timer: Proximal projection build = 13.2 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 663 ms
Timer: LinearConstraintProjection build = 2.84 sec
Number of parameters: 135
Number of objectives: 5043
Timer: Initializing the optimization = 16.9 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.172e-06                                    1.995e-04   
slurmstepd: error: *** JOB 64605215 ON della-l02g10 CANCELLED AT 2025-05-30T00:51:41 DUE TO TIME LIMIT ***
