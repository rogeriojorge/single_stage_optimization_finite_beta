DESC version 0.12.1+296.g65a64fdc9,using JAX backend, jax version=0.4.14, jaxlib version=0.4.14, dtype=float64
Using device: NVIDIA A100-SXM4-80GB (id=0), with 80.00 GB available memory
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 1.30 sec
Timer: Objective build = 1.94 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 1.15 sec
Timer: Objective build = 1.21 sec
Timer: Proximal projection build = 15.8 sec
Building objective: fixed Psi
Building objective: fixed current
Building objective: fixed pressure
Building objective: lcfs R
Building objective: lcfs Z
Timer: Objective build = 473 ms
Timer: Linear constraint projection build = 3.03 sec
Number of parameters: 39
Number of objectives: 15123
Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          5.934e+01                                    1.952e+01   
       1              2          3.947e+01      1.987e+01      5.033e+07      9.834e+00   
       2              3          1.380e+01      2.567e+01      1.151e+08      4.867e+00   
       3              4          4.796e-01      1.332e+01      1.823e+08      9.223e-01   
       4              5          2.657e-01      2.140e-01      4.414e+07      5.155e-01   
       5              6          2.195e-01      4.618e-02      2.943e+07      4.615e-01   
       6              7          9.794e-02      1.216e-01      8.194e+06      2.602e-01   
       7              9          7.109e-02      2.685e-02      4.129e+06      1.702e-01   
       8             11          6.500e-02      6.090e-03      1.708e+06      1.156e-01   
       9             12          5.963e-02      5.368e-03      1.284e+06      6.275e-02   
      10             13          5.678e-02      2.849e-03      2.658e+06      1.216e-01   
      11             15          5.146e-02      5.325e-03      1.645e+06      8.685e-02   
      12             16          4.939e-02      2.066e-03      7.570e+05      5.706e-02   
      13             18          4.846e-02      9.356e-04      7.803e+05      6.607e-02   
      14             19          4.765e-02      8.045e-04      1.239e+05      6.280e-02   
      15             20          4.616e-02      1.492e-03      2.671e+05      6.576e-02   
      16             21          4.366e-02      2.499e-03      6.062e+05      5.080e-02   
      17             23          4.317e-02      4.910e-04      1.028e+06      6.915e-02   
      18             24          4.264e-02      5.276e-04      3.662e+05      6.626e-02   
      19             25          4.231e-02      3.359e-04      3.183e+05      6.221e-02   
      20             26          4.212e-02      1.926e-04      1.071e+05      5.975e-02   
      21             27          4.186e-02      2.579e-04      4.439e+04      5.934e-02   
      22             28          4.113e-02      7.259e-04      3.695e+04      5.842e-02   
      23             29          3.984e-02      1.291e-03      6.585e+04      5.807e-02   
      24             30          3.798e-02      1.858e-03      3.649e+05      6.233e-02   
      25             31          3.620e-02      1.788e-03      4.325e+05      6.053e-02   
      26             32          3.429e-02      1.904e-03      1.528e+06      3.680e-02   
      27             34          3.343e-02      8.570e-04      6.794e+05      5.446e-02   
      28             35          3.318e-02      2.500e-04      3.107e+05      4.122e-02   
      29             36          3.289e-02      2.968e-04      7.609e+04      4.497e-02   
      30             37          3.277e-02      1.219e-04      4.168e+04      4.628e-02   
      31             38          3.243e-02      3.338e-04      2.432e+04      4.476e-02   
      32             39          3.204e-02      3.928e-04      2.824e+04      4.361e-02   
      33             40          3.145e-02      5.871e-04      1.461e+05      4.349e-02   
      34             41          3.075e-02      6.999e-04      2.563e+05      4.338e-02   
      35             43          3.027e-02      4.872e-04      3.189e+05      3.777e-02   
      36             44          3.016e-02      1.021e-04      1.216e+05      4.060e-02   
      37             45          3.005e-02      1.176e-04      3.141e+04      3.938e-02   
      38             46          2.998e-02      6.851e-05      2.041e+04      3.876e-02   
      39             47          2.991e-02      6.290e-05      1.463e+04      3.855e-02   
      40             48          2.985e-02      6.679e-05      1.227e+04      3.833e-02   
      41             49          2.978e-02      7.138e-05      9.812e+03      3.807e-02   
      42             50          2.965e-02      1.272e-04      4.148e+03      3.779e-02   
      43             51          2.939e-02      2.558e-04      3.137e+04      3.756e-02   
      44             52          2.895e-02      4.423e-04      7.875e+04      3.700e-02   
      45             53          2.837e-02      5.781e-04      5.309e+05      4.185e-02   
      46             55          2.791e-02      4.608e-04      9.828e+05      3.051e-02   
      47             56          2.778e-02      1.271e-04      8.015e+05      3.990e-02   
      48             57          2.763e-02      1.576e-04      2.385e+05      3.815e-02   
      49             58          2.752e-02      1.118e-04      2.165e+05      3.552e-02   
      50             59          2.729e-02      2.232e-04      1.062e+05      3.298e-02   
      51             60          2.708e-02      2.169e-04      3.403e+04      3.201e-02   
      52             61          2.680e-02      2.704e-04      9.467e+03      3.042e-02   
      53             62          2.646e-02      3.457e-04      2.507e+05      3.145e-02   
      54             64          2.636e-02      1.020e-04      5.701e+05      2.479e-02   
      55             65          2.620e-02      1.538e-04      1.473e+05      2.475e-02   
      56             66          2.612e-02      7.888e-05      2.453e+05      2.734e-02   
      57             67          2.606e-02      6.185e-05      1.783e+05      2.589e-02   
      58             68          2.601e-02      4.881e-05      1.329e+05      2.630e-02   
      59             69          2.598e-02      3.402e-05      1.272e+05      2.572e-02   
      60             104         2.598e-02      0.000e+00      0.000e+00      2.572e-02   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 2.598e-02
         Total delta_x: 3.186e+08
         Iterations: 60
         Function evaluations: 104
         Jacobian evaluations: 60
Timer: Solution time = 14.1 min
Timer: Avg time per step = 13.9 sec
Start of solver
Total (sum of squares):  5.934e+01, 
Maximum absolute Boundary normal field error:  1.912e-01 (T*m^2)
Minimum absolute Boundary normal field error:  1.297e-14 (T*m^2)
Average absolute Boundary normal field error:  4.390e-02 (T*m^2)
Maximum absolute Boundary normal field error:  1.073e-03 (normalized)
Minimum absolute Boundary normal field error:  7.281e-17 (normalized)
Average absolute Boundary normal field error:  2.464e-04 (normalized)
Maximum absolute Boundary magnetic pressure error:  6.149e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:  1.919e+01 (T^2*m^2)
Average absolute Boundary magnetic pressure error:  4.260e+01 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:  4.850e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:  1.514e-02 (normalized)
Average absolute Boundary magnetic pressure error:  3.361e-02 (normalized)
Maximum absolute Boundary field jump error:  4.164e+02 (T*m^2)
Minimum absolute Boundary field jump error:  1.438e+02 (T*m^2)
Average absolute Boundary field jump error:  3.019e+02 (T*m^2)
Maximum absolute Boundary field jump error:  2.337e+00 (normalized)
Minimum absolute Boundary field jump error:  8.072e-01 (normalized)
Average absolute Boundary field jump error:  1.695e+00 (normalized)
Fixed Psi error:  0.000e+00 (Wb)
Fixed current profile error:  0.000e+00 (A)
Fixed pressure profile error:  0.000e+00 (Pa)
Maximum absolute Force error:  1.024e+06 (N)
Minimum absolute Force error:  6.055e+00 (N)
Average absolute Force error:  4.294e+04 (N)
Maximum absolute Force error:  1.029e-04 (normalized)
Minimum absolute Force error:  6.082e-10 (normalized)
Average absolute Force error:  4.312e-06 (normalized)
R boundary error:  0.000e+00 (m)
Z boundary error:  0.000e+00 (m)
End of solver
Total (sum of squares):  2.598e-02, 
Maximum absolute Boundary normal field error:  9.178e+00 (T*m^2)
Minimum absolute Boundary normal field error:  2.019e-13 (T*m^2)
Average absolute Boundary normal field error:  2.969e+00 (T*m^2)
Maximum absolute Boundary normal field error:  5.152e-02 (normalized)
Minimum absolute Boundary normal field error:  1.133e-15 (normalized)
Average absolute Boundary normal field error:  1.667e-02 (normalized)
Maximum absolute Boundary magnetic pressure error:  6.541e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:  7.233e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:  1.265e+01 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:  5.160e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:  5.706e-07 (normalized)
Average absolute Boundary magnetic pressure error:  9.982e-03 (normalized)
Maximum absolute Boundary field jump error:  1.297e+01 (T*m^2)
Minimum absolute Boundary field jump error:  7.111e-02 (T*m^2)
Average absolute Boundary field jump error:  4.002e+00 (T*m^2)
Maximum absolute Boundary field jump error:  7.282e-02 (normalized)
Minimum absolute Boundary field jump error:  3.992e-04 (normalized)
Average absolute Boundary field jump error:  2.247e-02 (normalized)
Fixed Psi error:  0.000e+00 (Wb)
Fixed current profile error:  5.716e-09 (A)
Fixed pressure profile error:  1.164e-10 (Pa)
Maximum absolute Force error:  1.990e+06 (N)
Minimum absolute Force error:  1.154e-01 (N)
Average absolute Force error:  6.033e+04 (N)
Maximum absolute Force error:  1.999e-04 (normalized)
Minimum absolute Force error:  1.159e-11 (normalized)
Average absolute Force error:  6.059e-06 (normalized)
R boundary error:  4.831e-31 (m)
Z boundary error:  3.598e-31 (m)
0.5860754013567052
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 364 ms
Timer: Objective build = 384 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 129 ms
Timer: Objective build = 147 ms
Timer: Proximal projection build = 7.29 sec
Building objective: fixed Psi
Building objective: fixed current
Building objective: fixed pressure
Building objective: lcfs R
Building objective: lcfs Z
Timer: Objective build = 260 ms
Timer: Linear constraint projection build = 2.40 sec
Number of parameters: 123
Number of objectives: 15123
Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          7.478e-02                                    4.008e-01   
       1              3          3.471e-02      4.006e-02      1.770e+05      1.154e+00   
       2              5          2.904e-02      5.669e-03      2.589e+04      2.187e-01   
       3              6          2.896e-02      8.510e-05      2.026e+04      9.958e-01   
       4              7          2.687e-02      2.093e-03      4.215e+03      5.110e-01   
       5              8          2.595e-02      9.203e-04      3.354e+03      1.955e-01   
       6              9          2.557e-02      3.751e-04      3.602e+03      1.927e-01   
       7             10          2.540e-02      1.715e-04      7.286e+02      1.946e-01   
       8             11          2.537e-02      2.657e-05      1.967e+02      1.954e-01   
Traceback (most recent call last):
  File "/projects/EKOLEMEN/DESC/single_stage_optimization_finite_beta/optimization_finitebeta_nfp2_QA_stage1/rerun_with_opt_coilset.py", line 120, in <module>
    (eq,), _ = optimizer.optimize(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/dpanici/DESC/desc/optimize/optimizer.py", line 306, in optimize
    result = optimizers[method]["fun"](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dpanici/DESC/desc/optimize/_desc_wrappers.py", line 270, in _optimize_desc_least_squares
    result = lsqtr(
             ^^^^^^
  File "/home/dpanici/DESC/desc/optimize/least_squares.py", line 325, in lsqtr
    f_new = fun(x_new, *args)
            ^^^^^^^^^^^^^^^^^
  File "/home/dpanici/DESC/desc/optimize/_constraint_wrappers.py", line 223, in compute_scaled_error
    f = self._objective.compute_scaled_error(x, constants)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dpanici/DESC/desc/optimize/_constraint_wrappers.py", line 841, in compute_scaled_error
    xopt, _ = self._update_equilibrium(x, store=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dpanici/DESC/desc/optimize/_constraint_wrappers.py", line 773, in _update_equilibrium
    self._eq.solve(
  File "/home/dpanici/DESC/desc/equilibrium/equilibrium.py", line 2058, in solve
    things, result = optimizer.optimize(
                     ^^^^^^^^^^^^^^^^^^^
  File "/home/dpanici/DESC/desc/optimize/optimizer.py", line 244, in optimize
    objective.build(verbose=verbose)
  File "/home/dpanici/DESC/desc/optimize/_constraint_wrappers.py", line 110, in build
    ) = factorize_linear_constraints(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dpanici/DESC/desc/objectives/utils.py", line 158, in factorize_linear_constraints
    A_inv, Z = svd_inv_null(A)
               ^^^^^^^^^^^^^^^
  File "/home/dpanici/DESC/desc/utils.py", line 410, in svd_inv_null
    u, s, vh = np.linalg.svd(A, full_matrices=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<__array_function__ internals>", line 200, in svd
  File "/home/dpanici/.conda/envs/desc-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 1642, in svd
    u, s, vh = gufunc(a, signature=signature, extobj=extobj)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dpanici/.conda/envs/desc-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 98, in _raise_linalgerror_svd_nonconvergence
    raise LinAlgError("SVD did not converge")
numpy.linalg.LinAlgError: SVD did not converge
