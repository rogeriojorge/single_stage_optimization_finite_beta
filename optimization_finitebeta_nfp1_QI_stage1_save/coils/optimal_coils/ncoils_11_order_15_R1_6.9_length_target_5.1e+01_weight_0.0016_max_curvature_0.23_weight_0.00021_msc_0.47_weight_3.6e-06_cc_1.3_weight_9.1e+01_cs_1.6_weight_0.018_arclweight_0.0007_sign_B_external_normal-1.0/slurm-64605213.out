SAVING NO SHEET CURRENT SOLVE TO  /projects/EKOLEMEN/DESC/single_stage_optimization_finite_beta/optimization_finitebeta_nfp1_QI_stage1_save/coils/optimal_coils/ncoils_11_order_15_R1_6.9_length_target_5.1e+01_weight_0.0016_max_curvature_0.23_weight_0.00021_msc_0.47_weight_3.6e-06_cc_1.3_weight_9.1e+01_cs_1.6_weight_0.018_arclweight_0.0007_sign_B_external_normal-1.0/desc_fb_no_sheet_current.h5
SAVING  SHEET CURRENT SOLVE TO  /projects/EKOLEMEN/DESC/single_stage_optimization_finite_beta/optimization_finitebeta_nfp1_QI_stage1_save/coils/optimal_coils/ncoils_11_order_15_R1_6.9_length_target_5.1e+01_weight_0.0016_max_curvature_0.23_weight_0.00021_msc_0.47_weight_3.6e-06_cc_1.3_weight_9.1e+01_cs_1.6_weight_0.018_arclweight_0.0007_sign_B_external_normal-1.0/desc_fb_with_sheet_current.h5
/home/dpanici/DESC/desc/input_reader.py:1267: UserWarning: Current is not a power series!
  warnings.warn(colored("Current is not a power series!", "yellow"))
eq psi = 95.44138033701564
field psi = -96.28183436636441

==================================
Optimizing boundary modes M,N <= 1
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 181 ms
Timer: Objective build = 9.40 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 859 ms
Timer: Objective build = 920 ms
Timer: Objective build = 2.80 ms
Timer: Eq Update LinearConstraintProjection build = 9.15 sec
Timer: Proximal projection build = 22.5 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 631 ms
Timer: LinearConstraintProjection build = 2.74 sec
Number of parameters: 9
Number of objectives: 3362
Timer: Initializing the optimization = 26.0 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          6.045e-02                                    1.134e-01   
       1              2          4.835e-02      1.210e-02      2.239e-01      4.931e-02   
       2              3          4.676e-02      1.592e-03      1.934e-02      7.618e-04   
       3              4          4.676e-02      2.703e-06      1.852e-03      2.962e-05   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-04)
         Current function value: 4.676e-02
         Total delta_x: 2.439e-01
         Iterations: 3
         Function evaluations: 4
         Jacobian evaluations: 4
Timer: Solution time = 1.65 min
Timer: Avg time per step = 24.8 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      6.045e-02  -->   4.676e-02, 
Maximum absolute Boundary normal field error:                1.349e+01  -->   9.738e+00 (T*m^2)
Minimum absolute Boundary normal field error:                1.263e-13  -->   9.280e-14 (T*m^2)
Average absolute Boundary normal field error:                1.321e+00  -->   1.494e+00 (T*m^2)
Maximum absolute Boundary normal field error:                9.503e-02  -->   6.859e-02 (normalized)
Minimum absolute Boundary normal field error:                8.894e-16  -->   6.536e-16 (normalized)
Average absolute Boundary normal field error:                9.304e-03  -->   1.052e-02 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.602e+02  -->   1.307e+02 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           1.765e-03  -->   9.709e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           2.286e+01  -->   2.011e+01 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.638e-01  -->   2.152e-01 (normalized)
Minimum absolute Boundary magnetic pressure error:           2.906e-06  -->   1.599e-05 (normalized)
Average absolute Boundary magnetic pressure error:           3.764e-02  -->   3.311e-02 (normalized)
Maximum absolute Force error:                                2.363e+06  -->   2.413e+06 (N)
Minimum absolute Force error:                                5.857e+01  -->   1.086e+00 (N)
Average absolute Force error:                                7.803e+04  -->   7.781e+04 (N)
Maximum absolute Force error:                                4.955e-04  -->   5.059e-04 (normalized)
Minimum absolute Force error:                                1.228e-08  -->   2.276e-10 (normalized)
Average absolute Force error:                                1.636e-05  -->   1.632e-05 (normalized)
R boundary error:                                            0.000e+00  -->   2.222e-16 (m)
Z boundary error:                                            0.000e+00  -->   1.153e-16 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 2
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 185 ms
Timer: Objective build = 2.60 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 877 ms
Timer: Objective build = 941 ms
Timer: Objective build = 1.93 ms
Timer: Eq Update LinearConstraintProjection build = 5.96 sec
Timer: Proximal projection build = 12.7 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 641 ms
Timer: LinearConstraintProjection build = 2.70 sec
Number of parameters: 25
Number of objectives: 3362
Timer: Initializing the optimization = 16.1 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          4.286e-02                                    4.516e-02   
       1              3          3.121e-02      1.165e-02      2.999e-01      1.113e-01   
       2              4          2.030e-02      1.091e-02      1.852e-01      3.167e-02   
       3              6          1.855e-02      1.751e-03      8.830e-02      6.438e-03   
       4              7          1.729e-02      1.259e-03      1.783e-01      1.910e-02   
       5              9          1.647e-02      8.223e-04      8.674e-02      4.706e-03   
       6             10          1.600e-02      4.662e-04      1.733e-01      1.622e-02   
       7             11          1.568e-02      3.183e-04      1.631e-01      1.648e-02   
       8             12          1.531e-02      3.725e-04      7.298e-02      5.759e-03   
       9             13          1.505e-02      2.568e-04      8.524e-02      7.646e-03   
      10             14          1.477e-02      2.878e-04      7.650e-02      5.943e-03   
      11             15          1.464e-02      1.219e-04      4.154e-02      1.612e-03   
      12             16          1.462e-02      2.682e-05      1.895e-02      4.309e-04   
      13             17          1.462e-02      1.417e-06      9.034e-03      1.468e-04   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-04)
         Current function value: 1.462e-02
         Total delta_x: 1.171e+00
         Iterations: 13
         Function evaluations: 17
         Jacobian evaluations: 14
Timer: Solution time = 5.00 min
Timer: Avg time per step = 21.4 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      4.286e-02  -->   1.462e-02, 
Maximum absolute Boundary normal field error:                9.738e+00  -->   6.454e+00 (T*m^2)
Minimum absolute Boundary normal field error:                9.280e-14  -->   4.091e-14 (T*m^2)
Average absolute Boundary normal field error:                1.494e+00  -->   1.844e+00 (T*m^2)
Maximum absolute Boundary normal field error:                6.750e-02  -->   4.473e-02 (normalized)
Minimum absolute Boundary normal field error:                6.432e-16  -->   2.836e-16 (normalized)
Average absolute Boundary normal field error:                1.036e-02  -->   1.278e-02 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.307e+02  -->   6.218e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           9.709e-03  -->   2.138e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           2.011e+01  -->   1.045e+01 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.054e-01  -->   9.778e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.527e-05  -->   3.362e-06 (normalized)
Average absolute Boundary magnetic pressure error:           3.161e-02  -->   1.644e-02 (normalized)
Maximum absolute Force error:                                2.413e+06  -->   2.014e+06 (N)
Minimum absolute Force error:                                1.086e+00  -->   4.417e+00 (N)
Average absolute Force error:                                7.781e+04  -->   6.660e+04 (N)
Maximum absolute Force error:                                4.831e-04  -->   4.031e-04 (normalized)
Minimum absolute Force error:                                2.173e-10  -->   8.842e-10 (normalized)
Average absolute Force error:                                1.558e-05  -->   1.333e-05 (normalized)
R boundary error:                                            0.000e+00  -->   1.399e-17 (m)
Z boundary error:                                            0.000e+00  -->   3.927e-17 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 4
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 185 ms
Timer: Objective build = 2.71 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 881 ms
Timer: Objective build = 945 ms
Timer: Objective build = 1.91 ms
Timer: Eq Update LinearConstraintProjection build = 6.09 sec
Timer: Proximal projection build = 12.9 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 659 ms
Timer: LinearConstraintProjection build = 2.74 sec
Number of parameters: 81
Number of objectives: 3362
Timer: Initializing the optimization = 16.4 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          9.590e-03                                    3.081e-02   
       1              3          8.233e-03      1.358e-03      2.478e-01      6.904e-02   
       2              4          3.969e-03      4.264e-03      7.681e-02      2.246e-03   
       3              5          3.770e-03      1.993e-04      1.170e-01      6.602e-03   
       4              6          3.690e-03      7.950e-05      1.497e-01      1.017e-02   
       5              7          3.535e-03      1.549e-04      1.313e-01      6.735e-03   
       6              9          3.455e-03      7.985e-05      7.477e-02      4.359e-03   
       7             10          3.442e-03      1.317e-05      1.286e-01      1.012e-02   
       8             11          3.356e-03      8.602e-05      3.927e-02      1.608e-03   
       9             12          3.334e-03      2.226e-05      6.797e-02      4.014e-03   
      10             13          3.306e-03      2.776e-05      6.768e-02      3.529e-03   
      11             15          3.284e-03      2.257e-05      3.940e-02      1.193e-03   
      12             16          3.267e-03      1.651e-05      7.340e-02      3.794e-03   
      13             18          3.244e-03      2.323e-05      4.414e-02      1.769e-03   
      14             19          3.233e-03      1.037e-05      6.813e-02      4.279e-03   
      15             20          3.216e-03      1.717e-05      6.664e-02      2.880e-03   
      16             21          3.205e-03      1.171e-05      5.383e-02      9.746e-04   
      17             22          3.198e-03      6.189e-06      5.175e-02      1.921e-03   
      18             23          3.183e-03      1.492e-05      6.751e-02      3.019e-03   
      19             24          3.168e-03      1.586e-05      5.734e-02      1.840e-03   
      20             25          3.164e-03      3.483e-06      6.017e-02      3.382e-03   
      21             26          3.145e-03      1.900e-05      4.371e-02      6.021e-04   
      22             27          3.136e-03      9.055e-06      4.153e-02      2.024e-03   
      23             28          3.124e-03      1.219e-05      2.741e-02      2.816e-04   
      24             29          3.120e-03      3.453e-06      3.557e-02      1.457e-03   
      25             30          3.107e-03      1.289e-05      3.025e-02      4.791e-04   
      26             31          3.101e-03      6.831e-06      2.837e-02      8.437e-04   
      27             32          3.090e-03      1.037e-05      4.025e-02      6.710e-04   
      28             33          3.087e-03      2.937e-06      3.246e-02      1.372e-03   
      29             34          3.081e-03      6.355e-06      4.387e-02      1.047e-03   
      30             35          3.076e-03      5.269e-06      3.008e-02      1.265e-03   
      31             37          3.063e-03      1.223e-05      2.821e-02      9.913e-04   
      32             38          3.063e-03      3.740e-08      2.188e-02      4.040e-04   
      33             40          3.063e-03      6.970e-09      2.261e-03      8.638e-05   
      34             62          3.063e-03      0.000e+00      0.000e+00      8.638e-05   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 3.063e-03
         Total delta_x: 1.144e+00
         Iterations: 34
         Function evaluations: 62
         Jacobian evaluations: 34
Timer: Solution time = 7.81 min
Timer: Avg time per step = 13.4 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      9.590e-03  -->   3.063e-03, 
Maximum absolute Boundary normal field error:                6.459e+00  -->   4.875e+00 (T*m^2)
Minimum absolute Boundary normal field error:                2.697e-14  -->   2.259e-14 (T*m^2)
Average absolute Boundary normal field error:                1.836e+00  -->   1.034e+00 (T*m^2)
Maximum absolute Boundary normal field error:                4.030e-02  -->   3.042e-02 (normalized)
Minimum absolute Boundary normal field error:                1.683e-16  -->   1.410e-16 (normalized)
Average absolute Boundary normal field error:                1.146e-02  -->   6.451e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           5.559e+01  -->   3.012e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           1.884e-03  -->   9.721e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.037e+01  -->   6.082e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           6.683e-02  -->   3.621e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           2.265e-06  -->   1.169e-05 (normalized)
Average absolute Boundary magnetic pressure error:           1.247e-02  -->   7.311e-03 (normalized)
Maximum absolute Force error:                                2.014e+06  -->   4.996e+06 (N)
Minimum absolute Force error:                                4.417e+00  -->   1.064e+01 (N)
Average absolute Force error:                                6.660e+04  -->   1.375e+05 (N)
Maximum absolute Force error:                                3.082e-04  -->   7.647e-04 (normalized)
Minimum absolute Force error:                                6.760e-10  -->   1.628e-09 (normalized)
Average absolute Force error:                                1.019e-05  -->   2.105e-05 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 5
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 189 ms
Timer: Objective build = 2.78 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 894 ms
Timer: Objective build = 959 ms
Timer: Objective build = 1.90 ms
Timer: Eq Update LinearConstraintProjection build = 6.19 sec
Timer: Proximal projection build = 13.1 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 662 ms
Timer: LinearConstraintProjection build = 2.77 sec
Number of parameters: 121
Number of objectives: 3362
Timer: Initializing the optimization = 16.7 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          3.022e-03                                    7.800e-03   
       1              4          2.414e-03      6.072e-04      5.357e-02      4.678e-03   
       2              5          2.140e-03      2.740e-04      8.065e-02      2.285e-03   
       3              6          2.072e-03      6.815e-05      1.379e-01      1.308e-02   
       4              7          1.834e-03      2.385e-04      1.165e-01      4.773e-03   
       5              9          1.769e-03      6.447e-05      5.079e-02      2.302e-03   
       6             11          1.749e-03      1.992e-05      3.140e-02      9.218e-04   
       7             12          1.731e-03      1.883e-05      5.230e-02      2.776e-03   
       8             14          1.717e-03      1.338e-05      3.036e-02      9.672e-04   
       9             15          1.706e-03      1.137e-05      5.150e-02      2.641e-03   
      10             19          1.702e-03      3.434e-06      1.766e-03      1.923e-04   
      11             42          1.702e-03      0.000e+00      0.000e+00      1.923e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.702e-03
         Total delta_x: 4.176e-01
         Iterations: 11
         Function evaluations: 42
         Jacobian evaluations: 11
Timer: Solution time = 7.25 min
Timer: Avg time per step = 36.2 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      3.022e-03  -->   1.702e-03, 
Maximum absolute Boundary normal field error:                4.875e+00  -->   4.023e+00 (T*m^2)
Minimum absolute Boundary normal field error:                2.259e-14  -->   2.211e-14 (T*m^2)
Average absolute Boundary normal field error:                1.034e+00  -->   7.264e-01 (T*m^2)
Maximum absolute Boundary normal field error:                3.014e-02  -->   2.487e-02 (normalized)
Minimum absolute Boundary normal field error:                1.397e-16  -->   1.367e-16 (normalized)
Average absolute Boundary normal field error:                6.392e-03  -->   4.491e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           3.012e+01  -->   2.417e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           9.721e-03  -->   2.444e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           6.082e+00  -->   4.733e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           3.604e-02  -->   2.892e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.163e-05  -->   2.924e-06 (normalized)
Average absolute Boundary magnetic pressure error:           7.275e-03  -->   5.662e-03 (normalized)
Maximum absolute Force error:                                4.996e+06  -->   8.027e+06 (N)
Minimum absolute Force error:                                1.064e+01  -->   4.743e+01 (N)
Average absolute Force error:                                1.375e+05  -->   1.872e+05 (N)
Maximum absolute Force error:                                7.609e-04  -->   1.223e-03 (normalized)
Minimum absolute Force error:                                1.620e-09  -->   7.225e-09 (normalized)
Average absolute Force error:                                2.095e-05  -->   2.852e-05 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 7
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 191 ms
Timer: Objective build = 2.58 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 885 ms
Timer: Objective build = 948 ms
Timer: Objective build = 1.87 ms
Timer: Eq Update LinearConstraintProjection build = 5.99 sec
Timer: Proximal projection build = 12.7 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 639 ms
Timer: LinearConstraintProjection build = 2.73 sec
Number of parameters: 225
Number of objectives: 3362
Timer: Initializing the optimization = 16.2 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.795e-03                                    4.414e-03   
       1              4          1.634e-03      1.609e-04      5.200e-02      5.979e-03   
       2              5          1.426e-03      2.088e-04      5.350e-02      6.187e-03   
       3              6          1.414e-03      1.122e-05      4.908e-02      6.374e-03   
       4              7          1.302e-03      1.118e-04      1.444e-02      2.202e-03   
       5              9          1.274e-03      2.898e-05      8.582e-03      1.673e-03   
       6             10          1.264e-03      9.723e-06      7.531e-03      1.273e-03   
       7             12          1.258e-03      5.809e-06      2.133e-03      9.196e-04   
       8             13          1.253e-03      4.755e-06      4.153e-03      8.979e-04   
       9             14          1.250e-03      3.618e-06      4.390e-03      7.223e-04   
      10             15          1.247e-03      3.008e-06      4.205e-03      5.779e-04   
      11             16          1.242e-03      5.018e-06      4.302e-03      4.798e-04   
      12             17          1.238e-03      4.016e-06      4.046e-03      4.561e-04   
      13             18          1.236e-03      2.030e-06      4.155e-03      4.387e-04   
      14             19          1.231e-03      4.232e-06      3.900e-03      4.288e-04   
      15             22          1.231e-03      3.178e-07      4.617e-04      2.511e-04   
      16             44          1.231e-03      0.000e+00      0.000e+00      2.511e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.231e-03
         Total delta_x: 1.370e-01
         Iterations: 16
         Function evaluations: 44
         Jacobian evaluations: 16
Timer: Solution time = 4.74 min
Timer: Avg time per step = 16.7 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.795e-03  -->   1.231e-03, 
Maximum absolute Boundary normal field error:                4.023e+00  -->   2.296e+00 (T*m^2)
Minimum absolute Boundary normal field error:                2.211e-14  -->   1.190e-14 (T*m^2)
Average absolute Boundary normal field error:                7.264e-01  -->   5.786e-01 (T*m^2)
Maximum absolute Boundary normal field error:                2.519e-02  -->   1.437e-02 (normalized)
Minimum absolute Boundary normal field error:                1.385e-16  -->   7.452e-17 (normalized)
Average absolute Boundary normal field error:                4.549e-03  -->   3.623e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           2.417e+01  -->   1.705e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           2.444e-03  -->   6.263e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           4.733e+00  -->   4.009e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.994e-02  -->   2.112e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           3.028e-06  -->   7.758e-06 (normalized)
Average absolute Boundary magnetic pressure error:           5.863e-03  -->   4.966e-03 (normalized)
Maximum absolute Force error:                                8.027e+06  -->   6.502e+06 (N)
Minimum absolute Force error:                                4.743e+01  -->   2.256e+01 (N)
Average absolute Force error:                                1.872e+05  -->   2.668e+05 (N)
Maximum absolute Force error:                                1.266e-03  -->   1.025e-03 (normalized)
Minimum absolute Force error:                                7.480e-09  -->   3.558e-09 (normalized)
Average absolute Force error:                                2.953e-05  -->   4.208e-05 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 8
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 183 ms
Timer: Objective build = 2.56 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 868 ms
Timer: Objective build = 931 ms
Timer: Objective build = 1.86 ms
Timer: Eq Update LinearConstraintProjection build = 5.73 sec
Timer: Proximal projection build = 12.3 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 636 ms
Timer: LinearConstraintProjection build = 2.72 sec
Number of parameters: 289
Number of objectives: 3362
Timer: Initializing the optimization = 15.8 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.232e-03                                    2.653e-03   
       1              7          1.219e-03      1.259e-05      9.352e-04      1.757e-03   
       2              8          1.206e-03      1.268e-05      1.150e-03      1.156e-03   
       3             10          1.201e-03      5.092e-06      6.446e-04      9.343e-04   
       4             12          1.199e-03      1.976e-06      3.328e-04      8.467e-04   
       5             14          1.199e-03      3.768e-07      1.660e-04      8.640e-04   
       6             36          1.199e-03      0.000e+00      0.000e+00      8.640e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.199e-03
         Total delta_x: 2.900e-03
         Iterations: 6
         Function evaluations: 36
         Jacobian evaluations: 6
Timer: Solution time = 4.44 min
Timer: Avg time per step = 38.0 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.232e-03  -->   1.199e-03, 
Maximum absolute Boundary normal field error:                2.296e+00  -->   2.130e+00 (T*m^2)
Minimum absolute Boundary normal field error:                1.190e-14  -->   4.589e-15 (T*m^2)
Average absolute Boundary normal field error:                5.786e-01  -->   5.676e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.438e-02  -->   1.334e-02 (normalized)
Minimum absolute Boundary normal field error:                7.453e-17  -->   2.874e-17 (normalized)
Average absolute Boundary normal field error:                3.624e-03  -->   3.554e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.705e+01  -->   1.692e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           6.263e-03  -->   8.395e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           4.009e+00  -->   3.974e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.112e-02  -->   2.097e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           7.760e-06  -->   1.040e-05 (normalized)
Average absolute Boundary magnetic pressure error:           4.967e-03  -->   4.923e-03 (normalized)
Maximum absolute Force error:                                6.502e+06  -->   6.564e+06 (N)
Minimum absolute Force error:                                2.256e+01  -->   2.664e+01 (N)
Average absolute Force error:                                2.668e+05  -->   2.717e+05 (N)
Maximum absolute Force error:                                1.026e-03  -->   1.036e-03 (normalized)
Minimum absolute Force error:                                3.559e-09  -->   4.203e-09 (normalized)
Average absolute Force error:                                4.209e-05  -->   4.286e-05 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 10
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 187 ms
Timer: Objective build = 2.56 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 864 ms
Timer: Objective build = 926 ms
Timer: Objective build = 1.84 ms
Timer: Eq Update LinearConstraintProjection build = 5.96 sec
Timer: Proximal projection build = 12.6 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 507 ms
Timer: LinearConstraintProjection build = 2.58 sec
Number of parameters: 441
Number of objectives: 3362
Timer: Initializing the optimization = 15.8 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.199e-03                                    3.224e-03   
       1              9          1.196e-03      2.538e-06      4.251e-05      2.900e-03   
       2             10          1.195e-03      1.331e-06      9.147e-05      2.549e-03   
       3             11          1.194e-03      1.011e-06      9.815e-05      2.217e-03   
       4             32          1.194e-03      0.000e+00      0.000e+00      2.217e-03   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.194e-03
         Total delta_x: 2.282e-04
         Iterations: 4
         Function evaluations: 32
         Jacobian evaluations: 4
Timer: Solution time = 3.57 min
Timer: Avg time per step = 42.8 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.199e-03  -->   1.194e-03, 
Maximum absolute Boundary normal field error:                2.130e+00  -->   2.115e+00 (T*m^2)
Minimum absolute Boundary normal field error:                4.589e-15  -->   7.264e-16 (T*m^2)
Average absolute Boundary normal field error:                5.676e-01  -->   5.688e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.334e-02  -->   1.325e-02 (normalized)
Minimum absolute Boundary normal field error:                2.874e-17  -->   4.549e-18 (normalized)
Average absolute Boundary normal field error:                3.554e-03  -->   3.562e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.692e+01  -->   1.690e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           8.395e-03  -->   1.030e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           3.974e+00  -->   3.959e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.097e-02  -->   2.094e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.040e-05  -->   1.277e-06 (normalized)
Average absolute Boundary magnetic pressure error:           4.923e-03  -->   4.905e-03 (normalized)
Maximum absolute Force error:                                6.564e+06  -->   6.462e+06 (N)
Minimum absolute Force error:                                2.664e+01  -->   3.051e+01 (N)
Average absolute Force error:                                2.717e+05  -->   2.756e+05 (N)
Maximum absolute Force error:                                1.035e-03  -->   1.019e-03 (normalized)
Minimum absolute Force error:                                4.203e-09  -->   4.813e-09 (normalized)
Average absolute Force error:                                4.286e-05  -->   4.347e-05 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 1
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 519 ms
Timer: Objective build = 2.90 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 869 ms
Timer: Objective build = 931 ms
Timer: Objective build = 1.68 ms
Timer: Eq Update LinearConstraintProjection build = 6.39 sec
Timer: Proximal projection build = 13.6 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 637 ms
Timer: LinearConstraintProjection build = 2.82 sec
Number of parameters: 23
Number of objectives: 5043
Timer: Initializing the optimization = 17.2 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          2.057e-03                                    1.769e-02   
       1              2          1.878e-03      1.790e-04      4.387e+04      6.349e-03   
       2              3          1.853e-03      2.493e-05      2.995e+04      2.248e-03   
       3              5          1.848e-03      4.941e-06      1.176e+04      3.134e-04   
       4             28          1.848e-03      0.000e+00      0.000e+00      3.134e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.848e-03
         Total delta_x: 3.330e+04
         Iterations: 4
         Function evaluations: 28
         Jacobian evaluations: 4
Timer: Solution time = 1.72 min
Timer: Avg time per step = 20.6 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      2.057e-03  -->   1.848e-03, 
Maximum absolute Boundary normal field error:                2.115e+00  -->   2.017e+00 (T*m^2)
Minimum absolute Boundary normal field error:                7.264e-16  -->   5.995e-15 (T*m^2)
Average absolute Boundary normal field error:                5.688e-01  -->   5.282e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.325e-02  -->   1.263e-02 (normalized)
Minimum absolute Boundary normal field error:                4.549e-18  -->   3.754e-17 (normalized)
Average absolute Boundary normal field error:                3.562e-03  -->   3.308e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.690e+01  -->   1.693e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           1.030e-03  -->   2.752e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           3.959e+00  -->   3.971e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.094e-02  -->   2.098e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.277e-06  -->   3.410e-06 (normalized)
Average absolute Boundary magnetic pressure error:           4.905e-03  -->   4.920e-03 (normalized)
Maximum absolute Boundary field jump error:                  4.273e+00  -->   3.902e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  1.012e-02  -->   3.446e-03 (T*m^2)
Average absolute Boundary field jump error:                  8.469e-01  -->   7.682e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  2.676e-02  -->   2.444e-02 (normalized)
Minimum absolute Boundary field jump error:                  6.338e-05  -->   2.158e-05 (normalized)
Average absolute Boundary field jump error:                  5.303e-03  -->   4.811e-03 (normalized)
Maximum absolute Force error:                                6.462e+06  -->   6.450e+06 (N)
Minimum absolute Force error:                                3.051e+01  -->   5.141e+01 (N)
Average absolute Force error:                                2.756e+05  -->   2.758e+05 (N)
Maximum absolute Force error:                                1.019e-03  -->   1.017e-03 (normalized)
Minimum absolute Force error:                                4.813e-09  -->   8.109e-09 (normalized)
Average absolute Force error:                                4.347e-05  -->   4.351e-05 (normalized)
R boundary error:                                            0.000e+00  -->   2.243e-16 (m)
Z boundary error:                                            0.000e+00  -->   4.513e-17 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 2
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 519 ms
Timer: Objective build = 2.92 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 870 ms
Timer: Objective build = 934 ms
Timer: Objective build = 1.67 ms
Timer: Eq Update LinearConstraintProjection build = 6.18 sec
Timer: Proximal projection build = 13.4 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 647 ms
Timer: LinearConstraintProjection build = 2.81 sec
Number of parameters: 39
Number of objectives: 5043
Timer: Initializing the optimization = 16.9 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.845e-03                                    1.799e-03   
       1              2          1.811e-03      3.401e-05      5.126e+00      8.605e-04   
       2              3          1.806e-03      4.543e-06      4.498e+00      1.083e-03   
       3              7          1.806e-03      2.362e-07      1.955e+00      4.129e-04   
       4              8          1.806e-03      3.067e-07      4.690e-01      9.065e-05   
       5             31          1.806e-03      0.000e+00      0.000e+00      9.065e-05   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.806e-03
         Total delta_x: 5.900e+00
         Iterations: 5
         Function evaluations: 31
         Jacobian evaluations: 5
Timer: Solution time = 1.75 min
Timer: Avg time per step = 17.5 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.845e-03  -->   1.806e-03, 
Maximum absolute Boundary normal field error:                2.017e+00  -->   2.087e+00 (T*m^2)
Minimum absolute Boundary normal field error:                5.995e-15  -->   8.361e-15 (T*m^2)
Average absolute Boundary normal field error:                5.282e-01  -->   5.278e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.263e-02  -->   1.306e-02 (normalized)
Minimum absolute Boundary normal field error:                3.752e-17  -->   5.233e-17 (normalized)
Average absolute Boundary normal field error:                3.306e-03  -->   3.303e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.693e+01  -->   1.642e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           2.752e-03  -->   7.331e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           3.971e+00  -->   3.995e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.094e-02  -->   2.031e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           3.404e-06  -->   9.068e-06 (normalized)
Average absolute Boundary magnetic pressure error:           4.912e-03  -->   4.941e-03 (normalized)
Maximum absolute Boundary field jump error:                  3.902e+00  -->   3.664e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  3.446e-03  -->   1.379e-02 (T*m^2)
Average absolute Boundary field jump error:                  7.682e-01  -->   7.417e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  2.442e-02  -->   2.293e-02 (normalized)
Minimum absolute Boundary field jump error:                  2.156e-05  -->   8.629e-05 (normalized)
Average absolute Boundary field jump error:                  4.808e-03  -->   4.642e-03 (normalized)
Maximum absolute Force error:                                6.450e+06  -->   6.409e+06 (N)
Minimum absolute Force error:                                5.141e+01  -->   1.761e+01 (N)
Average absolute Force error:                                2.758e+05  -->   2.755e+05 (N)
Maximum absolute Force error:                                1.016e-03  -->   1.009e-03 (normalized)
Minimum absolute Force error:                                8.096e-09  -->   2.774e-09 (normalized)
Average absolute Force error:                                4.344e-05  -->   4.338e-05 (normalized)
R boundary error:                                            0.000e+00  -->   8.442e-18 (m)
Z boundary error:                                            0.000e+00  -->   1.054e-17 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 4
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 520 ms
Timer: Objective build = 2.90 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 874 ms
Timer: Objective build = 937 ms
Timer: Objective build = 1.67 ms
Timer: Eq Update LinearConstraintProjection build = 6.19 sec
Timer: Proximal projection build = 13.4 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 658 ms
Timer: LinearConstraintProjection build = 2.80 sec
Number of parameters: 95
Number of objectives: 5043
Timer: Initializing the optimization = 17.0 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.793e-03                                    5.401e-03   
       1              2          1.708e-03      8.425e-05      3.112e+00      5.694e-03   
       2              3          1.690e-03      1.862e-05      2.955e+00      4.607e-03   
       3              4          1.666e-03      2.374e-05      5.554e+00      2.121e-03   
       4              5          1.663e-03      2.995e-06      2.279e+00      1.539e-03   
       5              6          1.660e-03      2.723e-06      2.065e+00      1.057e-03   
       6              7          1.659e-03      1.176e-06      7.490e-01      5.209e-04   
       7              8          1.658e-03      8.753e-07      9.859e-01      5.656e-04   
       8              9          1.658e-03      3.531e-07      5.852e-01      3.040e-04   
       9             10          1.658e-03      1.486e-07      3.556e-01      2.417e-04   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-04)
         Current function value: 1.658e-03
         Total delta_x: 5.008e+00
         Iterations: 9
         Function evaluations: 10
         Jacobian evaluations: 10
Timer: Solution time = 1.65 min
Timer: Avg time per step = 9.93 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.793e-03  -->   1.658e-03, 
Maximum absolute Boundary normal field error:                2.087e+00  -->   2.453e+00 (T*m^2)
Minimum absolute Boundary normal field error:                8.361e-15  -->   2.022e-14 (T*m^2)
Average absolute Boundary normal field error:                5.278e-01  -->   5.042e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.303e-02  -->   1.532e-02 (normalized)
Minimum absolute Boundary normal field error:                5.222e-17  -->   1.263e-16 (normalized)
Average absolute Boundary normal field error:                3.297e-03  -->   3.149e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.642e+01  -->   1.912e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           7.331e-03  -->   8.632e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           3.995e+00  -->   4.036e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.020e-02  -->   2.352e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           9.019e-06  -->   1.062e-05 (normalized)
Average absolute Boundary magnetic pressure error:           4.914e-03  -->   4.965e-03 (normalized)
Maximum absolute Boundary field jump error:                  3.664e+00  -->   2.923e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  1.379e-02  -->   2.922e-02 (T*m^2)
Average absolute Boundary field jump error:                  7.417e-01  -->   6.686e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  2.288e-02  -->   1.826e-02 (normalized)
Minimum absolute Boundary field jump error:                  8.611e-05  -->   1.825e-04 (normalized)
Average absolute Boundary field jump error:                  4.632e-03  -->   4.176e-03 (normalized)
Maximum absolute Force error:                                6.409e+06  -->   7.019e+06 (N)
Minimum absolute Force error:                                1.761e+01  -->   2.144e+01 (N)
Average absolute Force error:                                2.755e+05  -->   2.736e+05 (N)
Maximum absolute Force error:                                1.004e-03  -->   1.100e-03 (normalized)
Minimum absolute Force error:                                2.759e-09  -->   3.358e-09 (normalized)
Average absolute Force error:                                4.315e-05  -->   4.286e-05 (normalized)
R boundary error:                                            0.000e+00  -->   1.399e-17 (m)
Z boundary error:                                            0.000e+00  -->   1.574e-17 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 5
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 519 ms
Timer: Objective build = 2.91 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 872 ms
Timer: Objective build = 935 ms
Timer: Objective build = 1.68 ms
Timer: Eq Update LinearConstraintProjection build = 6.26 sec
Timer: Proximal projection build = 13.4 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 659 ms
Timer: LinearConstraintProjection build = 2.51 sec
Number of parameters: 135
Number of objectives: 5043
Timer: Initializing the optimization = 16.7 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.657e-03                                    2.236e-03   
       1              2          1.598e-03      5.884e-05      3.429e+00      2.657e-03   
       2              3          1.569e-03      2.868e-05      2.915e+00      3.151e-03   
       3              4          1.545e-03      2.392e-05      4.982e+00      1.380e-03   
       4              5          1.539e-03      6.811e-06      3.889e+00      1.590e-03   
       5              8          1.537e-03      1.856e-06      3.923e+00      1.923e-03   
       6              9          1.535e-03      1.603e-06      8.678e-01      5.080e-04   
       7             32          1.535e-03      0.000e+00      0.000e+00      5.080e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.535e-03
         Total delta_x: 1.025e+01
         Iterations: 7
         Function evaluations: 32
         Jacobian evaluations: 7
Timer: Solution time = 2.37 min
Timer: Avg time per step = 17.7 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.657e-03  -->   1.535e-03, 
Maximum absolute Boundary normal field error:                2.453e+00  -->   2.361e+00 (T*m^2)
Minimum absolute Boundary normal field error:                2.022e-14  -->   5.587e-14 (T*m^2)
Average absolute Boundary normal field error:                5.042e-01  -->   5.006e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.532e-02  -->   1.475e-02 (normalized)
Minimum absolute Boundary normal field error:                1.263e-16  -->   3.490e-16 (normalized)
Average absolute Boundary normal field error:                3.150e-03  -->   3.127e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.912e+01  -->   1.829e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           8.632e-03  -->   1.460e-02 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           4.036e+00  -->   3.908e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.350e-02  -->   2.249e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.061e-05  -->   1.794e-05 (normalized)
Average absolute Boundary magnetic pressure error:           4.962e-03  -->   4.805e-03 (normalized)
Maximum absolute Boundary field jump error:                  2.923e+00  -->   2.470e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  2.922e-02  -->   2.373e-02 (T*m^2)
Average absolute Boundary field jump error:                  6.686e-01  -->   6.078e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.826e-02  -->   1.543e-02 (normalized)
Minimum absolute Boundary field jump error:                  1.825e-04  -->   1.482e-04 (normalized)
Average absolute Boundary field jump error:                  4.177e-03  -->   3.797e-03 (normalized)
Maximum absolute Force error:                                7.019e+06  -->   6.539e+06 (N)
Minimum absolute Force error:                                2.144e+01  -->   4.978e+01 (N)
Average absolute Force error:                                2.736e+05  -->   2.597e+05 (N)
Maximum absolute Force error:                                1.099e-03  -->   1.024e-03 (normalized)
Minimum absolute Force error:                                3.356e-09  -->   7.793e-09 (normalized)
Average absolute Force error:                                4.282e-05  -->   4.066e-05 (normalized)
R boundary error:                                            0.000e+00  -->   1.793e-18 (m)
Z boundary error:                                            0.000e+00  -->   3.130e-19 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 7
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 526 ms
Timer: Objective build = 2.94 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 887 ms
Timer: Objective build = 951 ms
Timer: Objective build = 1.67 ms
Timer: Eq Update LinearConstraintProjection build = 6.55 sec
Timer: Proximal projection build = 13.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 655 ms
Timer: LinearConstraintProjection build = 2.50 sec
Number of parameters: 239
Number of objectives: 5043
Timer: Initializing the optimization = 17.1 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.531e-03                                    3.216e-03   
       1              3          1.525e-03      5.605e-06      2.321e+00      7.493e-03   
       2              4          1.489e-03      3.655e-05      1.580e+00      4.473e-03   
       3              5          1.472e-03      1.687e-05      1.693e+00      2.257e-03   
       4              7          1.469e-03      2.371e-06      7.521e-01      1.051e-03   
       5              8          1.468e-03      1.559e-06      4.745e-01      6.331e-04   
       6              9          1.467e-03      8.002e-07      3.504e-01      3.869e-04   
       7             10          1.466e-03      6.652e-07      3.741e-01      3.062e-04   
       8             11          1.465e-03      9.813e-07      3.264e-01      2.825e-04   
       9             12          1.464e-03      1.417e-06      4.752e-01      2.933e-04   
      10             13          1.464e-03      7.940e-08      5.893e-01      5.218e-04   
      11             35          1.464e-03      0.000e+00      0.000e+00      5.218e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.464e-03
         Total delta_x: 4.151e+00
         Iterations: 11
         Function evaluations: 35
         Jacobian evaluations: 11
Timer: Solution time = 2.53 min
Timer: Avg time per step = 12.6 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.531e-03  -->   1.464e-03, 
Maximum absolute Boundary normal field error:                2.361e+00  -->   2.187e+00 (T*m^2)
Minimum absolute Boundary normal field error:                5.587e-14  -->   1.652e-14 (T*m^2)
Average absolute Boundary normal field error:                5.006e-01  -->   4.777e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.474e-02  -->   1.366e-02 (normalized)
Minimum absolute Boundary normal field error:                3.488e-16  -->   1.031e-16 (normalized)
Average absolute Boundary normal field error:                3.126e-03  -->   2.983e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.829e+01  -->   1.840e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           1.460e-02  -->   9.374e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           3.908e+00  -->   3.874e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.244e-02  -->   2.257e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.790e-05  -->   1.150e-05 (normalized)
Average absolute Boundary magnetic pressure error:           4.793e-03  -->   4.751e-03 (normalized)
Maximum absolute Boundary field jump error:                  2.470e+00  -->   2.442e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  2.373e-02  -->   3.688e-03 (T*m^2)
Average absolute Boundary field jump error:                  6.078e-01  -->   5.881e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.543e-02  -->   1.525e-02 (normalized)
Minimum absolute Boundary field jump error:                  1.481e-04  -->   2.303e-05 (normalized)
Average absolute Boundary field jump error:                  3.795e-03  -->   3.672e-03 (normalized)
Maximum absolute Force error:                                6.539e+06  -->   6.016e+06 (N)
Minimum absolute Force error:                                4.978e+01  -->   1.112e+01 (N)
Average absolute Force error:                                2.597e+05  -->   2.441e+05 (N)
Maximum absolute Force error:                                1.021e-03  -->   9.395e-04 (normalized)
Minimum absolute Force error:                                7.774e-09  -->   1.737e-09 (normalized)
Average absolute Force error:                                4.056e-05  -->   3.812e-05 (normalized)
R boundary error:                                            0.000e+00  -->   6.656e-20 (m)
Z boundary error:                                            0.000e+00  -->   1.857e-19 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 8
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 517 ms
Timer: Objective build = 2.93 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 875 ms
Timer: Objective build = 938 ms
Timer: Objective build = 1.71 ms
Timer: Eq Update LinearConstraintProjection build = 6.54 sec
Timer: Proximal projection build = 13.7 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 642 ms
Timer: LinearConstraintProjection build = 2.51 sec
Number of parameters: 303
Number of objectives: 5043
Timer: Initializing the optimization = 17.0 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.464e-03                                    3.574e-03   
       1              4          1.454e-03      9.547e-06      1.688e-01      2.959e-03   
       2              5          1.453e-03      9.048e-07      6.453e+00      3.848e-03   
       3              6          1.445e-03      8.468e-06      1.030e+00      1.533e-03   
       4              7          1.439e-03      6.280e-06      1.761e+00      1.673e-03   
       5              8          1.433e-03      5.417e-06      2.196e+00      9.965e-04   
       6             31          1.433e-03      0.000e+00      0.000e+00      9.965e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.433e-03
         Total delta_x: 2.098e+00
         Iterations: 6
         Function evaluations: 31
         Jacobian evaluations: 6
Timer: Solution time = 2.63 min
Timer: Avg time per step = 22.6 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.464e-03  -->   1.433e-03, 
Maximum absolute Boundary normal field error:                2.187e+00  -->   2.102e+00 (T*m^2)
Minimum absolute Boundary normal field error:                1.652e-14  -->   2.511e-14 (T*m^2)
Average absolute Boundary normal field error:                4.777e-01  -->   4.684e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.366e-02  -->   1.313e-02 (normalized)
Minimum absolute Boundary normal field error:                1.031e-16  -->   1.568e-16 (normalized)
Average absolute Boundary normal field error:                2.983e-03  -->   2.925e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.840e+01  -->   1.786e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           9.374e-03  -->   7.820e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           3.874e+00  -->   3.853e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.257e-02  -->   2.190e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.150e-05  -->   9.591e-07 (normalized)
Average absolute Boundary magnetic pressure error:           4.751e-03  -->   4.726e-03 (normalized)
Maximum absolute Boundary field jump error:                  2.442e+00  -->   2.353e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  3.688e-03  -->   6.187e-03 (T*m^2)
Average absolute Boundary field jump error:                  5.881e-01  -->   5.798e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.525e-02  -->   1.469e-02 (normalized)
Minimum absolute Boundary field jump error:                  2.303e-05  -->   3.863e-05 (normalized)
Average absolute Boundary field jump error:                  3.672e-03  -->   3.620e-03 (normalized)
Maximum absolute Force error:                                6.016e+06  -->   5.917e+06 (N)
Minimum absolute Force error:                                1.112e+01  -->   2.219e+01 (N)
Average absolute Force error:                                2.441e+05  -->   2.578e+05 (N)
Maximum absolute Force error:                                9.395e-04  -->   9.241e-04 (normalized)
Minimum absolute Force error:                                1.737e-09  -->   3.466e-09 (normalized)
Average absolute Force error:                                3.812e-05  -->   4.026e-05 (normalized)
R boundary error:                                            0.000e+00  -->   5.874e-21 (m)
Z boundary error:                                            0.000e+00  -->   4.893e-21 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 10
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 521 ms
Timer: Objective build = 2.91 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 872 ms
Timer: Objective build = 935 ms
Timer: Objective build = 1.69 ms
Timer: Eq Update LinearConstraintProjection build = 6.58 sec
Timer: Proximal projection build = 13.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 528 ms
Timer: LinearConstraintProjection build = 2.35 sec
Number of parameters: 455
Number of objectives: 5043
Timer: Initializing the optimization = 16.8 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.433e-03                                    3.033e-03   
       1              5          1.426e-03      7.117e-06      8.177e-01      2.400e-03   
       2              6          1.420e-03      6.534e-06      4.962e-01      2.209e-03   
       3             28          1.420e-03      0.000e+00      0.000e+00      2.209e-03   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.420e-03
         Total delta_x: 1.284e+00
         Iterations: 3
         Function evaluations: 28
         Jacobian evaluations: 3
Timer: Solution time = 2.84 min
Timer: Avg time per step = 42.7 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.433e-03  -->   1.420e-03, 
Maximum absolute Boundary normal field error:                2.102e+00  -->   2.240e+00 (T*m^2)
Minimum absolute Boundary normal field error:                2.511e-14  -->   3.063e-14 (T*m^2)
Average absolute Boundary normal field error:                4.684e-01  -->   4.677e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.313e-02  -->   1.399e-02 (normalized)
Minimum absolute Boundary normal field error:                1.568e-16  -->   1.912e-16 (normalized)
Average absolute Boundary normal field error:                2.925e-03  -->   2.921e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.786e+01  -->   1.800e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           7.820e-04  -->   2.023e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           3.853e+00  -->   3.837e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.190e-02  -->   2.207e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           9.591e-07  -->   2.481e-06 (normalized)
Average absolute Boundary magnetic pressure error:           4.726e-03  -->   4.706e-03 (normalized)
Maximum absolute Boundary field jump error:                  2.353e+00  -->   2.346e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  6.187e-03  -->   1.008e-02 (T*m^2)
Average absolute Boundary field jump error:                  5.798e-01  -->   5.729e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.469e-02  -->   1.465e-02 (normalized)
Minimum absolute Boundary field jump error:                  3.863e-05  -->   6.294e-05 (normalized)
Average absolute Boundary field jump error:                  3.620e-03  -->   3.577e-03 (normalized)
Maximum absolute Force error:                                5.917e+06  -->   5.952e+06 (N)
Minimum absolute Force error:                                2.219e+01  -->   2.378e+01 (N)
Average absolute Force error:                                2.578e+05  -->   2.653e+05 (N)
Maximum absolute Force error:                                9.241e-04  -->   9.294e-04 (normalized)
Minimum absolute Force error:                                3.466e-09  -->   3.713e-09 (normalized)
Average absolute Force error:                                4.026e-05  -->   4.143e-05 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================
