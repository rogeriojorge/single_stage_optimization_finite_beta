SAVING NO SHEET CURRENT SOLVE TO  /projects/EKOLEMEN/DESC/single_stage_optimization_finite_beta/optimization_finitebeta_nfp4_QI_stage1/coils/optimal_coils/ncoils_5_order_15_R1_5.4_length_target_4.5e+01_weight_0.078_max_curvature_0.22_weight_0.0023_msc_1.4_weight_2.8e-06_cc_1.2_weight_0.12_cs_1.1_weight_0.078_arclweight_0.00057_sign_B_external_normal1.0/desc_fb_no_sheet_current.h5
SAVING  SHEET CURRENT SOLVE TO  /projects/EKOLEMEN/DESC/single_stage_optimization_finite_beta/optimization_finitebeta_nfp4_QI_stage1/coils/optimal_coils/ncoils_5_order_15_R1_5.4_length_target_4.5e+01_weight_0.078_max_curvature_0.22_weight_0.0023_msc_1.4_weight_2.8e-06_cc_1.2_weight_0.12_cs_1.1_weight_0.078_arclweight_0.00057_sign_B_external_normal1.0/desc_fb_with_sheet_current.h5
/home/dpanici/DESC/desc/input_reader.py:1267: UserWarning: Current is not a power series!
  warnings.warn(colored("Current is not a power series!", "yellow"))
eq psi = 49.11009552685843
field psi = -50.00447864112009

==================================
Optimizing boundary modes M,N <= 1
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 178 ms
Timer: Objective build = 2.50 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 852 ms
Timer: Objective build = 914 ms
Timer: Objective build = 2.78 ms
Timer: Eq Update LinearConstraintProjection build = 6.14 sec
Timer: Proximal projection build = 12.6 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 633 ms
Timer: LinearConstraintProjection build = 2.79 sec
Number of parameters: 9
Number of objectives: 3362
Timer: Initializing the optimization = 16.2 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          8.952e-02                                    2.538e-01   
       1              2          4.038e-02      4.913e-02      6.308e-02      4.954e-03   
       2              3          4.036e-02      2.765e-05      3.929e-03      4.794e-05   
       3              4          4.035e-02      3.794e-06      6.756e-05      1.630e-05   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-04)
         Current function value: 4.035e-02
         Total delta_x: 6.255e-02
         Iterations: 3
         Function evaluations: 4
         Jacobian evaluations: 4
Timer: Solution time = 1.13 min
Timer: Avg time per step = 16.9 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      8.952e-02  -->   4.035e-02, 
Maximum absolute Boundary normal field error:                1.505e+01  -->   1.170e+01 (T*m^2)
Minimum absolute Boundary normal field error:                2.352e-13  -->   1.170e-13 (T*m^2)
Average absolute Boundary normal field error:                1.998e+00  -->   1.727e+00 (T*m^2)
Maximum absolute Boundary normal field error:                1.441e-01  -->   1.120e-01 (normalized)
Minimum absolute Boundary normal field error:                2.252e-15  -->   1.120e-15 (normalized)
Average absolute Boundary normal field error:                1.913e-02  -->   1.653e-02 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.063e+02  -->   7.019e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           2.228e-02  -->   2.669e-02 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           2.109e+01  -->   1.336e+01 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.261e-01  -->   1.494e-01 (normalized)
Minimum absolute Boundary magnetic pressure error:           4.742e-05  -->   5.680e-05 (normalized)
Average absolute Boundary magnetic pressure error:           4.490e-02  -->   2.844e-02 (normalized)
Maximum absolute Force error:                                3.097e+06  -->   2.745e+06 (N)
Minimum absolute Force error:                                2.322e+00  -->   2.760e+01 (N)
Average absolute Force error:                                5.942e+04  -->   5.789e+04 (N)
Maximum absolute Force error:                                8.392e-04  -->   7.438e-04 (normalized)
Minimum absolute Force error:                                6.291e-10  -->   7.480e-09 (normalized)
Average absolute Force error:                                1.610e-05  -->   1.569e-05 (normalized)
R boundary error:                                            0.000e+00  -->   2.232e-16 (m)
Z boundary error:                                            0.000e+00  -->   1.129e-16 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 2
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 191 ms
Timer: Objective build = 2.57 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 879 ms
Timer: Objective build = 942 ms
Timer: Objective build = 1.92 ms
Timer: Eq Update LinearConstraintProjection build = 5.99 sec
Timer: Proximal projection build = 12.7 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 635 ms
Timer: LinearConstraintProjection build = 2.72 sec
Number of parameters: 25
Number of objectives: 3362
Timer: Initializing the optimization = 16.1 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          4.129e-02                                    2.542e-02   
       1              2          3.295e-02      8.335e-03      1.831e-01      3.286e-02   
       2              3          3.201e-02      9.389e-04      3.362e-02      3.675e-03   
       3              4          3.195e-02      6.744e-05      1.649e-02      1.257e-03   
       4              5          3.193e-02      1.364e-05      9.750e-03      5.367e-04   
       5              6          3.193e-02      1.990e-07      5.810e-03      2.667e-04   
       6             31          3.193e-02      0.000e+00      0.000e+00      2.667e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 3.193e-02
         Total delta_x: 2.300e-01
         Iterations: 6
         Function evaluations: 31
         Jacobian evaluations: 6
Timer: Solution time = 2.76 min
Timer: Avg time per step = 23.7 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      4.129e-02  -->   3.193e-02, 
Maximum absolute Boundary normal field error:                1.170e+01  -->   8.057e+00 (T*m^2)
Minimum absolute Boundary normal field error:                1.170e-13  -->   1.997e-13 (T*m^2)
Average absolute Boundary normal field error:                1.727e+00  -->   1.681e+00 (T*m^2)
Maximum absolute Boundary normal field error:                1.123e-01  -->   7.735e-02 (normalized)
Minimum absolute Boundary normal field error:                1.123e-15  -->   1.917e-15 (normalized)
Average absolute Boundary normal field error:                1.658e-02  -->   1.614e-02 (normalized)
Maximum absolute Boundary magnetic pressure error:           7.019e+01  -->   6.691e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           2.669e-02  -->   2.932e-02 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.336e+01  -->   1.168e+01 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.516e-01  -->   1.445e-01 (normalized)
Minimum absolute Boundary magnetic pressure error:           5.763e-05  -->   6.331e-05 (normalized)
Average absolute Boundary magnetic pressure error:           2.885e-02  -->   2.522e-02 (normalized)
Maximum absolute Force error:                                2.745e+06  -->   1.181e+06 (N)
Minimum absolute Force error:                                2.760e+01  -->   7.105e+00 (N)
Average absolute Force error:                                5.789e+04  -->   3.979e+04 (N)
Maximum absolute Force error:                                7.547e-04  -->   3.247e-04 (normalized)
Minimum absolute Force error:                                7.589e-09  -->   1.953e-09 (normalized)
Average absolute Force error:                                1.592e-05  -->   1.094e-05 (normalized)
R boundary error:                                            0.000e+00  -->   5.111e-17 (m)
Z boundary error:                                            0.000e+00  -->   4.811e-17 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 4
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 187 ms
Timer: Objective build = 2.63 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 869 ms
Timer: Objective build = 933 ms
Timer: Objective build = 1.90 ms
Timer: Eq Update LinearConstraintProjection build = 6.00 sec
Timer: Proximal projection build = 12.7 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 654 ms
Timer: LinearConstraintProjection build = 2.74 sec
Number of parameters: 81
Number of objectives: 3362
Timer: Initializing the optimization = 16.3 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          2.917e-02                                    4.694e-02   
       1              2          1.535e-02      1.382e-02      2.234e-01      4.257e-02   
       2              4          1.245e-02      2.902e-03      7.747e-02      1.649e-02   
       3              6          1.196e-02      4.864e-04      3.781e-02      2.921e-03   
       4              7          1.175e-02      2.079e-04      7.147e-02      1.899e-02   
       5              8          1.134e-02      4.125e-04      7.104e-02      1.471e-02   
       6             10          1.105e-02      2.887e-04      3.563e-02      3.803e-03   
       7             11          1.089e-02      1.589e-04      6.644e-02      8.735e-03   
       8             12          1.067e-02      2.241e-04      8.621e-02      5.353e-03   
       9             13          1.052e-02      1.482e-04      6.791e-02      7.012e-03   
      10             14          1.038e-02      1.454e-04      7.474e-02      1.006e-02   
      11             15          1.022e-02      1.577e-04      9.186e-02      1.586e-02   
      12             16          1.008e-02      1.383e-04      1.056e-01      2.180e-02   
      13             17          9.620e-03      4.609e-04      9.728e-02      1.622e-02   
      14             18          9.323e-03      2.971e-04      7.926e-02      1.179e-02   
      15             19          9.157e-03      1.663e-04      5.318e-02      5.519e-03   
      16             20          9.110e-03      4.695e-05      3.601e-02      2.343e-03   
      17             21          9.092e-03      1.803e-05      2.780e-02      1.154e-03   
      18             22          9.080e-03      1.114e-05      2.273e-02      5.884e-04   
      19             23          9.072e-03      8.611e-06      1.891e-02      3.152e-04   
      20             24          9.068e-03      4.249e-06      1.573e-02      2.136e-04   
      21             26          9.066e-03      1.218e-06      4.676e-03      4.834e-05   
      22             27          9.065e-03      9.445e-07      4.083e-03      4.263e-05   
      23             28          9.065e-03      7.170e-07      3.826e-03      3.995e-05   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-04)
         Current function value: 9.065e-03
         Total delta_x: 9.718e-01
         Iterations: 23
         Function evaluations: 28
         Jacobian evaluations: 24
Timer: Solution time = 6.42 min
Timer: Avg time per step = 16.0 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      2.917e-02  -->   9.065e-03, 
Maximum absolute Boundary normal field error:                8.057e+00  -->   4.388e+00 (T*m^2)
Minimum absolute Boundary normal field error:                2.191e-13  -->   3.638e-13 (T*m^2)
Average absolute Boundary normal field error:                1.681e+00  -->   1.021e+00 (T*m^2)
Maximum absolute Boundary normal field error:                7.552e-02  -->   4.113e-02 (normalized)
Minimum absolute Boundary normal field error:                2.054e-15  -->   3.410e-15 (normalized)
Average absolute Boundary normal field error:                1.576e-02  -->   9.568e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           6.690e+01  -->   3.325e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           2.435e-02  -->   3.633e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.168e+01  -->   6.644e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.369e-01  -->   6.806e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           4.983e-05  -->   7.437e-07 (normalized)
Average absolute Boundary magnetic pressure error:           2.390e-02  -->   1.360e-02 (normalized)
Maximum absolute Force error:                                1.181e+06  -->   3.706e+06 (N)
Minimum absolute Force error:                                7.105e+00  -->   4.833e+01 (N)
Average absolute Force error:                                3.979e+04  -->   1.358e+05 (N)
Maximum absolute Force error:                                3.078e-04  -->   9.658e-04 (normalized)
Minimum absolute Force error:                                1.852e-09  -->   1.260e-08 (normalized)
Average absolute Force error:                                1.037e-05  -->   3.540e-05 (normalized)
R boundary error:                                            0.000e+00  -->   2.465e-32 (m)
Z boundary error:                                            0.000e+00  -->   9.861e-32 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 5
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 190 ms
Timer: Objective build = 2.58 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 1.02 sec
Timer: Objective build = 1.09 sec
Timer: Objective build = 1.92 ms
Timer: Eq Update LinearConstraintProjection build = 6.23 sec
Timer: Proximal projection build = 13.1 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 653 ms
Timer: LinearConstraintProjection build = 2.57 sec
Number of parameters: 121
Number of objectives: 3362
Timer: Initializing the optimization = 16.4 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          5.652e-03                                    1.025e-02   
       1              3          4.239e-03      1.412e-03      5.102e-02      3.381e-03   
       2              4          4.118e-03      1.211e-04      1.225e-01      8.205e-03   
       3              5          3.843e-03      2.753e-04      1.071e-01      5.428e-03   
       4              7          3.728e-03      1.144e-04      4.768e-02      2.447e-03   
       5              8          3.630e-03      9.845e-05      4.521e-02      1.601e-03   
       6              9          3.546e-03      8.356e-05      7.813e-02      6.533e-03   
       7             11          3.409e-03      1.372e-04      3.867e-02      1.394e-03   
       8             12          3.352e-03      5.742e-05      6.785e-02      4.686e-03   
       9             14          3.303e-03      4.831e-05      3.381e-02      1.477e-03   
      10             15          3.280e-03      2.339e-05      3.400e-02      2.453e-03   
      11             16          3.222e-03      5.850e-05      3.857e-02      3.455e-03   
      12             18          3.199e-03      2.281e-05      1.972e-02      1.097e-03   
      13             19          3.184e-03      1.519e-05      1.938e-02      9.783e-04   
      14             20          3.165e-03      1.816e-05      3.753e-02      4.185e-03   
      15             21          3.159e-03      6.793e-06      3.701e-02      4.022e-03   
      16             22          3.123e-03      3.599e-05      1.045e-02      2.603e-04   
      17             23          3.112e-03      1.074e-05      1.910e-02      9.948e-04   
      18             24          3.105e-03      6.762e-06      1.798e-02      8.110e-04   
      19             25          3.101e-03      4.023e-06      1.753e-02      6.754e-04   
      20             26          3.098e-03      3.313e-06      1.736e-02      5.877e-04   
      21             27          3.096e-03      1.940e-06      1.738e-02      5.270e-04   
      22             52          3.096e-03      0.000e+00      0.000e+00      5.270e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 3.096e-03
         Total delta_x: 6.114e-01
         Iterations: 22
         Function evaluations: 52
         Jacobian evaluations: 22
Timer: Solution time = 5.83 min
Timer: Avg time per step = 15.2 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      5.652e-03  -->   3.096e-03, 
Maximum absolute Boundary normal field error:                4.387e+00  -->   4.591e+00 (T*m^2)
Minimum absolute Boundary normal field error:                4.185e-13  -->   2.262e-13 (T*m^2)
Average absolute Boundary normal field error:                1.021e+00  -->   8.355e-01 (T*m^2)
Maximum absolute Boundary normal field error:                3.648e-02  -->   3.817e-02 (normalized)
Minimum absolute Boundary normal field error:                3.479e-15  -->   1.880e-15 (normalized)
Average absolute Boundary normal field error:                8.486e-03  -->   6.946e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           3.327e+01  -->   2.698e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           7.583e-04  -->   7.397e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           6.642e+00  -->   4.481e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           5.049e-02  -->   4.094e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.151e-06  -->   1.123e-05 (normalized)
Average absolute Boundary magnetic pressure error:           1.008e-02  -->   6.800e-03 (normalized)
Maximum absolute Force error:                                3.706e+06  -->   2.210e+07 (N)
Minimum absolute Force error:                                4.833e+01  -->   8.675e+00 (N)
Average absolute Force error:                                1.358e+05  -->   3.034e+05 (N)
Maximum absolute Force error:                                7.161e-04  -->   4.271e-03 (normalized)
Minimum absolute Force error:                                9.339e-09  -->   1.676e-09 (normalized)
Average absolute Force error:                                2.625e-05  -->   5.864e-05 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 7
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 192 ms
Timer: Objective build = 2.77 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 883 ms
Timer: Objective build = 947 ms
Timer: Objective build = 1.92 ms
Timer: Eq Update LinearConstraintProjection build = 6.23 sec
Timer: Proximal projection build = 13.1 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 645 ms
Timer: LinearConstraintProjection build = 2.78 sec
Number of parameters: 225
Number of objectives: 3362
Timer: Initializing the optimization = 16.6 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          3.449e-03                                    9.131e-03   
       1              3          2.847e-03      6.016e-04      9.129e-02      1.410e-02   
       2              4          2.260e-03      5.865e-04      1.017e-01      1.383e-02   
       3              6          1.487e-03      7.731e-04      2.620e-02      1.997e-03   
       4              8          1.445e-03      4.195e-05      1.509e-02      1.763e-03   
       5              9          1.386e-03      5.916e-05      1.339e-02      1.729e-03   
       6             11          1.379e-03      6.821e-06      3.406e-03      1.377e-03   
       7             12          1.350e-03      2.960e-05      7.740e-04      5.338e-04   
       8             15          1.350e-03      1.573e-07      8.799e-05      1.628e-04   
       9             37          1.350e-03      0.000e+00      0.000e+00      1.628e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.350e-03
         Total delta_x: 1.803e-01
         Iterations: 9
         Function evaluations: 37
         Jacobian evaluations: 9
Timer: Solution time = 3.40 min
Timer: Avg time per step = 20.4 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      3.449e-03  -->   1.350e-03, 
Maximum absolute Boundary normal field error:                4.591e+00  -->   3.475e+00 (T*m^2)
Minimum absolute Boundary normal field error:                2.262e-13  -->   4.558e-13 (T*m^2)
Average absolute Boundary normal field error:                8.355e-01  -->   5.856e-01 (T*m^2)
Maximum absolute Boundary normal field error:                3.927e-02  -->   2.972e-02 (normalized)
Minimum absolute Boundary normal field error:                1.934e-15  -->   3.899e-15 (normalized)
Average absolute Boundary normal field error:                7.146e-03  -->   5.009e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           2.698e+01  -->   2.151e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           7.397e-03  -->   5.249e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           4.481e+00  -->   2.268e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           4.424e-02  -->   3.527e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.213e-05  -->   8.607e-06 (normalized)
Average absolute Boundary magnetic pressure error:           7.347e-03  -->   3.718e-03 (normalized)
Maximum absolute Force error:                                2.210e+07  -->   1.621e+07 (N)
Minimum absolute Force error:                                8.675e+00  -->   1.299e+01 (N)
Average absolute Force error:                                3.034e+05  -->   4.690e+05 (N)
Maximum absolute Force error:                                4.615e-03  -->   3.384e-03 (normalized)
Minimum absolute Force error:                                1.811e-09  -->   2.711e-09 (normalized)
Average absolute Force error:                                6.335e-05  -->   9.791e-05 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 8
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 192 ms
Timer: Objective build = 2.62 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 895 ms
Timer: Objective build = 959 ms
Timer: Objective build = 1.91 ms
Timer: Eq Update LinearConstraintProjection build = 6.34 sec
Timer: Proximal projection build = 13.1 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 650 ms
Timer: LinearConstraintProjection build = 2.81 sec
Number of parameters: 289
Number of objectives: 3362
Timer: Initializing the optimization = 16.7 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.370e-03                                    4.171e-03   
       1              3          1.229e-03      1.415e-04      7.649e-02      7.301e-03   
       2              4          9.147e-04      3.140e-04      2.081e-02      4.217e-03   
       3              5          8.104e-04      1.043e-04      2.124e-02      2.171e-03   
       4              6          7.933e-04      1.712e-05      2.304e-02      3.723e-03   
       5              7          6.989e-04      9.439e-05      5.704e-03      1.014e-03   
       6              8          6.856e-04      1.334e-05      1.275e-02      1.749e-03   
       7             10          6.668e-04      1.882e-05      3.008e-03      1.285e-03   
       8             11          6.525e-04      1.429e-05      2.759e-03      6.291e-04   
       9             14          6.495e-04      2.933e-06      3.259e-04      1.601e-04   
      10             16          6.493e-04      2.551e-07      1.746e-04      8.234e-05   
      11             39          6.493e-04      0.000e+00      0.000e+00      8.234e-05   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 6.493e-04
         Total delta_x: 1.270e-01
         Iterations: 11
         Function evaluations: 39
         Jacobian evaluations: 11
Timer: Solution time = 3.06 min
Timer: Avg time per step = 15.3 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.370e-03  -->   6.493e-04, 
Maximum absolute Boundary normal field error:                3.475e+00  -->   2.113e+00 (T*m^2)
Minimum absolute Boundary normal field error:                4.558e-13  -->   4.301e-13 (T*m^2)
Average absolute Boundary normal field error:                5.856e-01  -->   4.101e-01 (T*m^2)
Maximum absolute Boundary normal field error:                2.988e-02  -->   1.817e-02 (normalized)
Minimum absolute Boundary normal field error:                3.920e-15  -->   3.699e-15 (normalized)
Average absolute Boundary normal field error:                5.036e-03  -->   3.527e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           2.151e+01  -->   1.423e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           5.249e-03  -->   1.363e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           2.268e+00  -->   1.580e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           3.564e-02  -->   2.357e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           8.696e-06  -->   2.258e-06 (normalized)
Average absolute Boundary magnetic pressure error:           3.757e-03  -->   2.618e-03 (normalized)
Maximum absolute Force error:                                1.621e+07  -->   2.427e+07 (N)
Minimum absolute Force error:                                1.299e+01  -->   1.216e+02 (N)
Average absolute Force error:                                4.690e+05  -->   6.163e+05 (N)
Maximum absolute Force error:                                3.419e-03  -->   5.120e-03 (normalized)
Minimum absolute Force error:                                2.739e-09  -->   2.566e-08 (normalized)
Average absolute Force error:                                9.892e-05  -->   1.300e-04 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 10
====================================
Building objective: Boundary error
/home/dpanici/DESC/desc/utils.py:563: UserWarning: Boundary pressure is nonzero (max 72.0979485308053 Pa), a sheet current should be included.
  warnings.warn(colored(msg, "yellow"), err)
Precomputing transforms
Timer: Precomputing transforms = 196 ms
Timer: Objective build = 2.64 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 894 ms
Timer: Objective build = 959 ms
Timer: Objective build = 1.94 ms
Timer: Eq Update LinearConstraintProjection build = 6.06 sec
Timer: Proximal projection build = 13.0 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 538 ms
Timer: LinearConstraintProjection build = 2.65 sec
Number of parameters: 441
Number of objectives: 3362
Timer: Initializing the optimization = 16.4 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          6.633e-04                                    2.203e-03   
       1              6          5.953e-04      6.804e-05      7.464e-04      1.784e-03   
       2              8          5.768e-04      1.846e-05      4.125e-04      7.764e-04   
       3              9          5.662e-04      1.065e-05      4.337e-04      1.574e-03   
       4             10          5.549e-04      1.127e-05      4.468e-04      8.602e-04   
       5             11          5.442e-04      1.074e-05      4.656e-04      6.071e-04   
       6             12          5.295e-04      1.465e-05      1.002e-03      1.178e-03   
       7             13          5.149e-04      1.460e-05      1.082e-03      1.182e-03   
       8             14          4.934e-04      2.159e-05      2.344e-03      1.547e-03   
       9             15          4.819e-04      1.149e-05      5.201e-03      2.132e-03   
      10             17          4.662e-04      1.564e-05      1.260e-03      2.482e-03   
      11             19          4.595e-04      6.718e-06      2.748e-04      7.322e-04   
      12             20          4.577e-04      1.835e-06      3.094e-04      5.540e-04   
      13             21          4.576e-04      2.549e-08      3.131e-04      8.420e-04   
      14             22          4.569e-04      7.166e-07      6.898e-05      3.602e-04   
      15             23          4.565e-04      4.391e-07      7.452e-05      1.880e-04   
      16             45          4.565e-04      0.000e+00      0.000e+00      1.880e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 4.565e-04
         Total delta_x: 1.197e-02
         Iterations: 16
         Function evaluations: 45
         Jacobian evaluations: 16
Timer: Solution time = 3.45 min
Timer: Avg time per step = 12.1 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      6.633e-04  -->   4.565e-04, 
Maximum absolute Boundary normal field error:                2.113e+00  -->   1.694e+00 (T*m^2)
Minimum absolute Boundary normal field error:                4.301e-13  -->   6.113e-13 (T*m^2)
Average absolute Boundary normal field error:                4.101e-01  -->   3.445e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.831e-02  -->   1.468e-02 (normalized)
Minimum absolute Boundary normal field error:                3.728e-15  -->   5.298e-15 (normalized)
Average absolute Boundary normal field error:                3.555e-03  -->   2.985e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.423e+01  -->   9.425e+00 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           1.363e-03  -->   9.460e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.580e+00  -->   1.259e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           2.393e-02  -->   1.585e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           2.293e-06  -->   1.591e-06 (normalized)
Average absolute Boundary magnetic pressure error:           2.658e-03  -->   2.118e-03 (normalized)
Maximum absolute Force error:                                2.427e+07  -->   2.805e+07 (N)
Minimum absolute Force error:                                1.216e+02  -->   2.593e+02 (N)
Average absolute Force error:                                6.163e+05  -->   6.837e+05 (N)
Maximum absolute Force error:                                5.199e-03  -->   6.008e-03 (normalized)
Minimum absolute Force error:                                2.605e-08  -->   5.554e-08 (normalized)
Average absolute Force error:                                1.320e-04  -->   1.464e-04 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 1
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 537 ms
Timer: Objective build = 3.17 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 909 ms
Timer: Objective build = 972 ms
Timer: Objective build = 1.71 ms
Timer: Eq Update LinearConstraintProjection build = 6.37 sec
Timer: Proximal projection build = 14.0 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 933 ms
Timer: LinearConstraintProjection build = 2.64 sec
Number of parameters: 23
Number of objectives: 5043
Timer: Initializing the optimization = 17.7 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          7.779e-04                                    7.139e-03   
       1              2          7.313e-04      4.658e-05      4.544e+04      1.914e-03   
       2              3          7.306e-04      7.199e-07      5.708e+04      2.533e-03   
       3              4          7.277e-04      2.899e-06      1.454e+04      6.150e-04   
       4              5          7.274e-04      2.471e-07      2.289e+04      2.422e-04   
       5              6          7.274e-04      6.236e-08      9.204e+03      2.921e-04   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-04)
         Current function value: 7.274e-04
         Total delta_x: 1.806e+04
         Iterations: 5
         Function evaluations: 6
         Jacobian evaluations: 6
Timer: Solution time = 1.06 min
Timer: Avg time per step = 10.6 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      7.779e-04  -->   7.274e-04, 
Maximum absolute Boundary normal field error:                1.694e+00  -->   1.691e+00 (T*m^2)
Minimum absolute Boundary normal field error:                6.113e-13  -->   2.536e-13 (T*m^2)
Average absolute Boundary normal field error:                3.445e-01  -->   3.264e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.469e-02  -->   1.466e-02 (normalized)
Minimum absolute Boundary normal field error:                5.300e-15  -->   2.198e-15 (normalized)
Average absolute Boundary normal field error:                2.986e-03  -->   2.829e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           9.425e+00  -->   8.911e+00 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           9.460e-04  -->   8.858e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.259e+00  -->   1.291e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.586e-02  -->   1.500e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.592e-06  -->   1.491e-06 (normalized)
Average absolute Boundary magnetic pressure error:           2.119e-03  -->   2.172e-03 (normalized)
Maximum absolute Boundary field jump error:                  1.772e+00  -->   1.795e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  2.079e-02  -->   2.100e-02 (T*m^2)
Average absolute Boundary field jump error:                  3.907e-01  -->   3.742e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.537e-02  -->   1.556e-02 (normalized)
Minimum absolute Boundary field jump error:                  1.802e-04  -->   1.821e-04 (normalized)
Average absolute Boundary field jump error:                  3.388e-03  -->   3.244e-03 (normalized)
Maximum absolute Force error:                                2.805e+07  -->   2.812e+07 (N)
Minimum absolute Force error:                                2.593e+02  -->   1.512e+01 (N)
Average absolute Force error:                                6.837e+05  -->   6.835e+05 (N)
Maximum absolute Force error:                                6.011e-03  -->   6.026e-03 (normalized)
Minimum absolute Force error:                                5.556e-08  -->   3.241e-09 (normalized)
Average absolute Force error:                                1.465e-04  -->   1.465e-04 (normalized)
R boundary error:                                            0.000e+00  -->   4.235e-17 (m)
Z boundary error:                                            0.000e+00  -->   1.010e-16 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 2
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 534 ms
Timer: Objective build = 2.95 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 896 ms
Timer: Objective build = 960 ms
Timer: Objective build = 1.70 ms
Timer: Eq Update LinearConstraintProjection build = 6.29 sec
Timer: Proximal projection build = 13.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 668 ms
Timer: LinearConstraintProjection build = 2.88 sec
Number of parameters: 39
Number of objectives: 5043
Timer: Initializing the optimization = 17.5 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          7.272e-04                                    1.129e-03   
       1              2          7.009e-04      2.625e-05      2.799e+00      1.330e-03   
       2              3          7.004e-04      5.018e-07      2.664e+00      2.760e-03   
       3              5          6.981e-04      2.288e-06      2.064e+00      1.668e-03   
       4              7          6.972e-04      9.486e-07      4.895e-01      2.466e-04   
       5              8          6.971e-04      7.202e-08      4.009e-01      1.452e-04   
       6             30          6.971e-04      0.000e+00      0.000e+00      1.452e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 6.971e-04
         Total delta_x: 2.006e+00
         Iterations: 6
         Function evaluations: 30
         Jacobian evaluations: 6
Timer: Solution time = 1.76 min
Timer: Avg time per step = 15.1 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      7.272e-04  -->   6.971e-04, 
Maximum absolute Boundary normal field error:                1.691e+00  -->   1.707e+00 (T*m^2)
Minimum absolute Boundary normal field error:                2.536e-13  -->   6.277e-13 (T*m^2)
Average absolute Boundary normal field error:                3.264e-01  -->   3.150e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.466e-02  -->   1.480e-02 (normalized)
Minimum absolute Boundary normal field error:                2.198e-15  -->   5.442e-15 (normalized)
Average absolute Boundary normal field error:                2.829e-03  -->   2.731e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           8.911e+00  -->   9.147e+00 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           8.858e-04  -->   2.256e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.291e+00  -->   1.349e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.499e-02  -->   1.539e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.490e-06  -->   3.796e-06 (normalized)
Average absolute Boundary magnetic pressure error:           2.171e-03  -->   2.270e-03 (normalized)
Maximum absolute Boundary field jump error:                  1.795e+00  -->   1.765e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  2.100e-02  -->   1.142e-02 (T*m^2)
Average absolute Boundary field jump error:                  3.742e-01  -->   3.594e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.556e-02  -->   1.530e-02 (normalized)
Minimum absolute Boundary field jump error:                  1.820e-04  -->   9.900e-05 (normalized)
Average absolute Boundary field jump error:                  3.244e-03  -->   3.115e-03 (normalized)
Maximum absolute Force error:                                2.812e+07  -->   2.813e+07 (N)
Minimum absolute Force error:                                1.512e+01  -->   3.070e+01 (N)
Average absolute Force error:                                6.835e+05  -->   6.839e+05 (N)
Maximum absolute Force error:                                6.024e-03  -->   6.025e-03 (normalized)
Minimum absolute Force error:                                3.240e-09  -->   6.577e-09 (normalized)
Average absolute Force error:                                1.464e-04  -->   1.465e-04 (normalized)
R boundary error:                                            0.000e+00  -->   2.776e-16 (m)
Z boundary error:                                            0.000e+00  -->   2.741e-16 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 4
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 538 ms
Timer: Objective build = 3.02 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 893 ms
Timer: Objective build = 958 ms
Timer: Objective build = 1.69 ms
Timer: Eq Update LinearConstraintProjection build = 6.41 sec
Timer: Proximal projection build = 13.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 704 ms
Timer: LinearConstraintProjection build = 2.92 sec
Number of parameters: 95
Number of objectives: 5043
Timer: Initializing the optimization = 17.5 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          6.970e-04                                    1.754e-03   
       1              2          6.479e-04      4.914e-05      7.370e+00      1.801e-03   
       2              3          6.353e-04      1.259e-05      7.013e+00      1.146e-03   
       3              4          6.333e-04      2.033e-06      1.260e+01      2.306e-03   
       4              6          6.320e-04      1.215e-06      1.209e+01      1.989e-03   
       5              7          6.299e-04      2.134e-06      4.046e+00      4.114e-04   
       6              8          6.295e-04      3.831e-07      1.374e+00      3.184e-04   
       7              9          6.292e-04      3.381e-07      1.212e+00      3.980e-04   
       8             10          6.291e-04      1.045e-07      1.969e+00      6.687e-04   
       9             11          6.287e-04      3.907e-07      1.441e+00      2.395e-04   
      10             12          6.286e-04      1.018e-07      7.278e-01      1.760e-04   
      11             13          6.285e-04      1.172e-07      1.305e+00      3.301e-04   
      12             15          6.284e-04      8.435e-08      8.909e-01      1.378e-04   
      13             16          6.283e-04      8.594e-08      2.609e-01      8.700e-05   
      14             17          6.283e-04      4.735e-08      5.085e-01      1.480e-04   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-04)
         Current function value: 6.283e-04
         Total delta_x: 7.008e+00
         Iterations: 14
         Function evaluations: 17
         Jacobian evaluations: 15
Timer: Solution time = 1.58 min
Timer: Avg time per step = 6.35 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      6.970e-04  -->   6.283e-04, 
Maximum absolute Boundary normal field error:                1.707e+00  -->   1.540e+00 (T*m^2)
Minimum absolute Boundary normal field error:                6.277e-13  -->   3.773e-13 (T*m^2)
Average absolute Boundary normal field error:                3.150e-01  -->   2.902e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.480e-02  -->   1.335e-02 (normalized)
Minimum absolute Boundary normal field error:                5.442e-15  -->   3.271e-15 (normalized)
Average absolute Boundary normal field error:                2.731e-03  -->   2.516e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           9.147e+00  -->   1.057e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           2.256e-03  -->   3.148e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.349e+00  -->   1.415e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.538e-02  -->   1.778e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           3.795e-06  -->   5.294e-07 (normalized)
Average absolute Boundary magnetic pressure error:           2.269e-03  -->   2.379e-03 (normalized)
Maximum absolute Boundary field jump error:                  1.765e+00  -->   1.697e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  1.142e-02  -->   6.287e-03 (T*m^2)
Average absolute Boundary field jump error:                  3.594e-01  -->   3.219e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.530e-02  -->   1.472e-02 (normalized)
Minimum absolute Boundary field jump error:                  9.901e-05  -->   5.450e-05 (normalized)
Average absolute Boundary field jump error:                  3.116e-03  -->   2.791e-03 (normalized)
Maximum absolute Force error:                                2.813e+07  -->   2.816e+07 (N)
Minimum absolute Force error:                                3.070e+01  -->   7.418e+00 (N)
Average absolute Force error:                                6.839e+05  -->   6.728e+05 (N)
Maximum absolute Force error:                                6.023e-03  -->   6.031e-03 (normalized)
Minimum absolute Force error:                                6.574e-09  -->   1.589e-09 (normalized)
Average absolute Force error:                                1.464e-04  -->   1.441e-04 (normalized)
R boundary error:                                            0.000e+00  -->   2.366e-17 (m)
Z boundary error:                                            0.000e+00  -->   5.851e-17 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 5
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 531 ms
Timer: Objective build = 3.23 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 881 ms
Timer: Objective build = 944 ms
Timer: Objective build = 1.69 ms
Timer: Eq Update LinearConstraintProjection build = 6.32 sec
Timer: Proximal projection build = 13.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 666 ms
Timer: LinearConstraintProjection build = 2.84 sec
Number of parameters: 135
Number of objectives: 5043
Timer: Initializing the optimization = 17.5 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          6.261e-04                                    1.452e-03   
       1              2          6.108e-04      1.526e-05      1.022e+00      7.378e-04   
       2              3          6.086e-04      2.203e-06      9.585e-01      1.157e-03   
       3              7          6.079e-04      6.954e-07      6.293e-01      3.342e-04   
       4              8          6.079e-04      2.330e-08      3.480e-01      3.099e-04   
       5             30          6.079e-04      0.000e+00      0.000e+00      3.099e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 6.079e-04
         Total delta_x: 1.006e+00
         Iterations: 5
         Function evaluations: 30
         Jacobian evaluations: 5
Timer: Solution time = 1.82 min
Timer: Avg time per step = 18.2 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      6.261e-04  -->   6.079e-04, 
Maximum absolute Boundary normal field error:                1.540e+00  -->   1.588e+00 (T*m^2)
Minimum absolute Boundary normal field error:                3.773e-13  -->   3.730e-13 (T*m^2)
Average absolute Boundary normal field error:                2.902e-01  -->   2.827e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.334e-02  -->   1.375e-02 (normalized)
Minimum absolute Boundary normal field error:                3.267e-15  -->   3.230e-15 (normalized)
Average absolute Boundary normal field error:                2.513e-03  -->   2.448e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.057e+01  -->   1.039e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           3.148e-04  -->   5.421e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.415e+00  -->   1.417e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.773e-02  -->   1.741e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           5.278e-07  -->   9.090e-06 (normalized)
Average absolute Boundary magnetic pressure error:           2.372e-03  -->   2.376e-03 (normalized)
Maximum absolute Boundary field jump error:                  1.697e+00  -->   1.745e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  6.287e-03  -->   9.777e-03 (T*m^2)
Average absolute Boundary field jump error:                  3.219e-01  -->   3.136e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.470e-02  -->   1.511e-02 (normalized)
Minimum absolute Boundary field jump error:                  5.444e-05  -->   8.466e-05 (normalized)
Average absolute Boundary field jump error:                  2.787e-03  -->   2.716e-03 (normalized)
Maximum absolute Force error:                                2.816e+07  -->   2.820e+07 (N)
Minimum absolute Force error:                                7.418e+00  -->   1.189e+01 (N)
Average absolute Force error:                                6.728e+05  -->   6.668e+05 (N)
Maximum absolute Force error:                                6.013e-03  -->   6.020e-03 (normalized)
Minimum absolute Force error:                                1.584e-09  -->   2.539e-09 (normalized)
Average absolute Force error:                                1.436e-04  -->   1.424e-04 (normalized)
R boundary error:                                            0.000e+00  -->   2.214e-17 (m)
Z boundary error:                                            0.000e+00  -->   1.300e-17 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 7
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 526 ms
Timer: Objective build = 2.96 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 886 ms
Timer: Objective build = 949 ms
Timer: Objective build = 1.69 ms
Timer: Eq Update LinearConstraintProjection build = 6.37 sec
Timer: Proximal projection build = 13.6 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 658 ms
Timer: LinearConstraintProjection build = 2.91 sec
Number of parameters: 239
Number of objectives: 5043
Timer: Initializing the optimization = 17.3 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          6.073e-04                                    1.236e-03   
       1              2          5.805e-04      2.680e-05      1.483e+00      2.008e-03   
       2              3          5.648e-04      1.568e-05      2.263e+00      2.138e-03   
       3              4          5.551e-04      9.727e-06      3.536e+00      3.097e-03   
       4              8          5.486e-04      6.480e-06      1.336e+00      8.830e-04   
       5              9          5.470e-04      1.589e-06      8.591e-01      3.134e-04   
       6             10          5.466e-04      4.509e-07      4.361e-01      1.722e-04   
       7             11          5.465e-04      9.110e-08      2.399e-01      1.883e-04   
       8             13          5.465e-04      7.545e-09      2.220e-01      1.829e-04   
       9             14          5.464e-04      6.164e-09      6.616e-02      4.032e-05   
      10             34          5.464e-04      0.000e+00      0.000e+00      4.032e-05   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 5.464e-04
         Total delta_x: 2.630e+00
         Iterations: 10
         Function evaluations: 34
         Jacobian evaluations: 10
Timer: Solution time = 2.14 min
Timer: Avg time per step = 11.7 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      6.073e-04  -->   5.464e-04, 
Maximum absolute Boundary normal field error:                1.588e+00  -->   1.801e+00 (T*m^2)
Minimum absolute Boundary normal field error:                3.730e-13  -->   4.039e-13 (T*m^2)
Average absolute Boundary normal field error:                2.827e-01  -->   2.673e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.375e-02  -->   1.559e-02 (normalized)
Minimum absolute Boundary normal field error:                3.229e-15  -->   3.496e-15 (normalized)
Average absolute Boundary normal field error:                2.447e-03  -->   2.314e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.039e+01  -->   1.000e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           5.421e-03  -->   6.135e-03 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.417e+00  -->   1.370e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.740e-02  -->   1.676e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           9.081e-06  -->   1.028e-05 (normalized)
Average absolute Boundary magnetic pressure error:           2.374e-03  -->   2.295e-03 (normalized)
Maximum absolute Boundary field jump error:                  1.745e+00  -->   1.794e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  9.777e-03  -->   1.151e-02 (T*m^2)
Average absolute Boundary field jump error:                  3.136e-01  -->   2.882e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.511e-02  -->   1.553e-02 (normalized)
Minimum absolute Boundary field jump error:                  8.464e-05  -->   9.962e-05 (normalized)
Average absolute Boundary field jump error:                  2.715e-03  -->   2.495e-03 (normalized)
Maximum absolute Force error:                                2.820e+07  -->   2.405e+07 (N)
Minimum absolute Force error:                                1.189e+01  -->   5.518e+01 (N)
Average absolute Force error:                                6.668e+05  -->   6.662e+05 (N)
Maximum absolute Force error:                                6.014e-03  -->   5.129e-03 (normalized)
Minimum absolute Force error:                                2.536e-09  -->   1.177e-08 (normalized)
Average absolute Force error:                                1.422e-04  -->   1.421e-04 (normalized)
R boundary error:                                            0.000e+00  -->   9.713e-18 (m)
Z boundary error:                                            0.000e+00  -->   1.062e-17 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 8
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 525 ms
Timer: Objective build = 3.20 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 902 ms
Timer: Objective build = 965 ms
Timer: Objective build = 1.68 ms
Timer: Eq Update LinearConstraintProjection build = 6.44 sec
Timer: Proximal projection build = 14.0 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 670 ms
Timer: LinearConstraintProjection build = 2.91 sec
Number of parameters: 303
Number of objectives: 5043
Timer: Initializing the optimization = 17.7 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          5.486e-04                                    1.003e-03   
       1              3          5.475e-04      1.126e-06      8.699e-01      1.539e-03   
       2              4          5.434e-04      4.098e-06      1.031e+00      4.102e-04   
       3             28          5.434e-04      0.000e+00      0.000e+00      4.102e-04   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 5.434e-04
         Total delta_x: 4.662e-01
         Iterations: 3
         Function evaluations: 28
         Jacobian evaluations: 3
Timer: Solution time = 1.77 min
Timer: Avg time per step = 26.6 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      5.486e-04  -->   5.434e-04, 
Maximum absolute Boundary normal field error:                1.801e+00  -->   1.705e+00 (T*m^2)
Minimum absolute Boundary normal field error:                4.039e-13  -->   3.526e-13 (T*m^2)
Average absolute Boundary normal field error:                2.673e-01  -->   2.678e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.561e-02  -->   1.478e-02 (normalized)
Minimum absolute Boundary normal field error:                3.501e-15  -->   3.057e-15 (normalized)
Average absolute Boundary normal field error:                2.317e-03  -->   2.321e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.000e+01  -->   1.017e+01 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           6.135e-03  -->   3.994e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.370e+00  -->   1.363e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.681e-02  -->   1.709e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           1.031e-05  -->   6.714e-07 (normalized)
Average absolute Boundary magnetic pressure error:           2.303e-03  -->   2.291e-03 (normalized)
Maximum absolute Boundary field jump error:                  1.794e+00  -->   1.806e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  1.151e-02  -->   6.844e-03 (T*m^2)
Average absolute Boundary field jump error:                  2.882e-01  -->   2.892e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.555e-02  -->   1.565e-02 (normalized)
Minimum absolute Boundary field jump error:                  9.975e-05  -->   5.932e-05 (normalized)
Average absolute Boundary field jump error:                  2.498e-03  -->   2.507e-03 (normalized)
Maximum absolute Force error:                                2.405e+07  -->   2.636e+07 (N)
Minimum absolute Force error:                                5.518e+01  -->   1.106e+02 (N)
Average absolute Force error:                                6.662e+05  -->   6.678e+05 (N)
Maximum absolute Force error:                                5.146e-03  -->   5.642e-03 (normalized)
Minimum absolute Force error:                                1.181e-08  -->   2.368e-08 (normalized)
Average absolute Force error:                                1.426e-04  -->   1.429e-04 (normalized)
R boundary error:                                            0.000e+00  -->   6.196e-19 (m)
Z boundary error:                                            0.000e+00  -->   5.032e-19 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

==================================
Optimizing boundary modes M,N <= 10
====================================
Building objective: Boundary error
Precomputing transforms
Timer: Precomputing transforms = 525 ms
Timer: Objective build = 2.95 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 901 ms
Timer: Objective build = 965 ms
Timer: Objective build = 1.73 ms
Timer: Eq Update LinearConstraintProjection build = 6.47 sec
Timer: Proximal projection build = 13.8 sec
Building objective: lcfs R
Building objective: lcfs Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 541 ms
Timer: LinearConstraintProjection build = 2.40 sec
Number of parameters: 455
Number of objectives: 5043
Timer: Initializing the optimization = 16.8 sec

Starting optimization
Using method: proximal-lsq-exact
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          5.434e-04                                    9.861e-04   
       1              3          5.315e-04      1.188e-05      8.010e-01      3.033e-03   
       2              4          5.163e-04      1.525e-05      1.148e+00      2.108e-03   
       3              5          5.123e-04      4.017e-06      1.336e+00      2.589e-03   
       4              6          5.020e-04      1.031e-05      1.286e+00      1.596e-03   
       5              7          5.012e-04      7.778e-07      1.329e+00      1.987e-03   
       6              8          4.985e-04      2.688e-06      5.463e-01      4.064e-04   
       7              9          4.980e-04      5.378e-07      1.108e-01      3.383e-04   
       8             10          4.975e-04      4.224e-07      2.156e-01      1.281e-04   
       9             11          4.973e-04      2.673e-07      1.309e-01      2.137e-04   
      10             12          4.970e-04      2.966e-07      9.409e-02      9.015e-05   
      11             13          4.966e-04      3.331e-07      9.668e-02      1.378e-04   
      12             14          4.964e-04      2.164e-07      5.465e-02      1.311e-04   
      13             15          4.960e-04      3.868e-07      6.584e-02      9.637e-05   
      14             16          4.959e-04      1.778e-07      3.529e-02      1.549e-04   
      15             17          4.954e-04      4.127e-07      4.982e-02      7.799e-05   
      16             18          4.953e-04      1.695e-07      3.404e-02      1.657e-04   
      17             19          4.949e-04      4.165e-07      4.470e-02      7.369e-05   
      18             20          4.947e-04      1.828e-07      3.909e-02      1.660e-04   
      19             21          4.943e-04      4.052e-07      4.285e-02      7.207e-05   
      20             22          4.941e-04      2.085e-07      4.167e-02      1.595e-04   
      21             23          4.937e-04      3.862e-07      3.994e-02      7.854e-05   
      22             24          4.934e-04      2.393e-07      4.063e-02      1.495e-04   
      23             25          4.931e-04      3.657e-07      3.526e-02      8.679e-05   
      24             26          4.928e-04      2.702e-07      3.718e-02      1.378e-04   
      25             27          4.925e-04      3.476e-07      2.967e-02      9.490e-05   
      26             28          4.922e-04      2.983e-07      3.231e-02      1.267e-04   
      27             29          4.918e-04      3.344e-07      2.391e-02      1.014e-04   
      28             30          4.915e-04      3.216e-07      2.724e-02      1.170e-04   
      29             31          4.912e-04      3.273e-07      1.916e-02      1.057e-04   
      30             32          4.908e-04      3.400e-07      2.288e-02      1.089e-04   
      31             33          4.905e-04      3.258e-07      1.611e-02      1.076e-04   
      32             34          4.902e-04      3.538e-07      1.965e-02      1.024e-04   
      33             35          4.898e-04      3.293e-07      1.479e-02      1.074e-04   
      34             36          4.895e-04      3.639e-07      1.758e-02      9.728e-05   
      35             37          4.891e-04      3.363e-07      1.459e-02      1.055e-04   
      36             38          4.888e-04      3.715e-07      1.637e-02      9.317e-05   
      37             39          4.884e-04      3.457e-07      1.480e-02      1.023e-04   
      38             40          4.880e-04      3.774e-07      1.567e-02      8.975e-05   
      39             41          4.877e-04      3.564e-07      1.500e-02      9.827e-05   
      40             42          4.873e-04      3.825e-07      1.521e-02      8.672e-05   
      41             43          4.869e-04      3.675e-07      1.507e-02      9.369e-05   
      42             44          4.865e-04      3.871e-07      1.489e-02      8.385e-05   
      43             45          4.859e-04      6.351e-07      2.818e-02      1.955e-04   
      44             46          4.850e-04      8.641e-07      4.380e-02      9.024e-05   
      45             47          4.839e-04      1.100e-06      8.530e-02      4.148e-04   
      46             48          4.821e-04      1.884e-06      1.780e-01      2.244e-04   
      47             49          4.805e-04      1.524e-06      3.414e-01      8.573e-04   
      48             50          4.762e-04      4.368e-06      7.231e-01      9.221e-04   
      49             53          4.758e-04      3.719e-07      5.656e-01      5.032e-04   
      50             54          4.747e-04      1.048e-06      1.005e-01      3.281e-04   
Warning: Maximum number of iterations has been exceeded.
         Current function value: 4.747e-04
         Total delta_x: 1.714e+00
         Iterations: 50
         Function evaluations: 54
         Jacobian evaluations: 51
Timer: Solution time = 4.58 min
Timer: Avg time per step = 5.38 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      5.434e-04  -->   4.747e-04, 
Maximum absolute Boundary normal field error:                1.705e+00  -->   1.485e+00 (T*m^2)
Minimum absolute Boundary normal field error:                3.526e-13  -->   5.519e-13 (T*m^2)
Average absolute Boundary normal field error:                2.678e-01  -->   2.539e-01 (T*m^2)
Maximum absolute Boundary normal field error:                1.478e-02  -->   1.288e-02 (normalized)
Minimum absolute Boundary normal field error:                3.057e-15  -->   4.784e-15 (normalized)
Average absolute Boundary normal field error:                2.321e-03  -->   2.201e-03 (normalized)
Maximum absolute Boundary magnetic pressure error:           1.017e+01  -->   9.645e+00 (T^2*m^2)
Minimum absolute Boundary magnetic pressure error:           3.994e-04  -->   4.136e-04 (T^2*m^2)
Average absolute Boundary magnetic pressure error:           1.363e+00  -->   1.273e+00 (T^2*m^2)
Maximum absolute Boundary magnetic pressure error:           1.709e-02  -->   1.621e-02 (normalized)
Minimum absolute Boundary magnetic pressure error:           6.714e-07  -->   6.952e-07 (normalized)
Average absolute Boundary magnetic pressure error:           2.291e-03  -->   2.140e-03 (normalized)
Maximum absolute Boundary field jump error:                  1.806e+00  -->   1.588e+00 (T*m^2)
Minimum absolute Boundary field jump error:                  6.844e-03  -->   7.838e-03 (T*m^2)
Average absolute Boundary field jump error:                  2.892e-01  -->   2.724e-01 (T*m^2)
Maximum absolute Boundary field jump error:                  1.565e-02  -->   1.376e-02 (normalized)
Minimum absolute Boundary field jump error:                  5.932e-05  -->   6.794e-05 (normalized)
Average absolute Boundary field jump error:                  2.507e-03  -->   2.361e-03 (normalized)
Maximum absolute Force error:                                2.636e+07  -->   2.505e+07 (N)
Minimum absolute Force error:                                1.106e+02  -->   8.178e+01 (N)
Average absolute Force error:                                6.678e+05  -->   6.900e+05 (N)
Maximum absolute Force error:                                5.642e-03  -->   5.361e-03 (normalized)
Minimum absolute Force error:                                2.368e-08  -->   1.750e-08 (normalized)
Average absolute Force error:                                1.429e-04  -->   1.477e-04 (normalized)
R boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Z boundary error:                                            0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================
